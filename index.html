
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zaytoon Garden Multan - Premium Dining | Order Online</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Zaytoon Garden Multan - Order premium food online. Best BBQ, Fast Food, and Traditional Cuisine. Cash on Delivery Available.">
    <meta name="keywords" content="Zaytoon Garden, Multan Restaurant, Online Food Order, BBQ, Fast Food, Home Delivery">
    
    <!-- External Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css" />

    <style>
        :root {
            --primary: #2e7d32;
            --secondary: #1b5e20;
            --dark: #1a1a1a;
            --light: #f1f8f4;
            --white: #ffffff;
            --accent: #4caf50;
            --text-dark: #2d2d2d;
            --shadow: rgba(0, 0, 0, 0.15);
            --gradient-green: linear-gradient(135deg, #2e7d32 0%, #4caf50 100%);
            --gradient-dark: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            --whatsapp: #25D366;
            --success: #28a745;
            --danger: #dc3545;
            --info: #17a2b8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--light);
            color: var(--text-dark);
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Cormorant Garamond', serif;
            font-weight: 600;
        }

        /* Loading Screen */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--dark);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            transition: opacity 0.5s ease;
        }

        .loader {
            width: 60px;
            height: 60px;
            border: 4px solid var(--primary);
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Sticky Order Button - Moved to right */
        .sticky-order-btn {
            position: fixed;
            bottom: 190px; /* Adjusted position */
            right: 30px; /* Moved to right */
            z-index: 999;
            background: var(--gradient-green);
            color: var(--white);
            padding: 18px 35px;
            border-radius: 50px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 10px 30px rgba(46, 125, 50, 0.5);
            animation: pulse 2s infinite;
            cursor: pointer;
            border: none;
            font-size: 1.1rem;
            transition: all 0.3s ease; /* Added transition for hover */
        }

        .sticky-order-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(46, 125, 50, 0.7);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* WhatsApp Float Button - Adjusted position */
        .whatsapp-float {
            position: fixed;
            bottom: 260px;
            right: 30px;
            width: 70px;
            height: 70px;
            background: var(--whatsapp);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(37, 211, 102, 0.5);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .whatsapp-float:hover {
            transform: scale(1.15);
            box-shadow: 0 12px 35px rgba(37, 211, 102, 0.7);
        }

        .whatsapp-float i {
            font-size: 2.2rem;
            color: var(--white);
        }

        /* Call Float Button - Adjusted position */
        .call-float {
            position: fixed;
            bottom: 120px; /* Adjusted position */
            right: 30px;
            width: 70px;
            height: 70px;
            background: #ff6b6b;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.5);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .call-float:hover {
            transform: scale(1.15);
            box-shadow: 0 12px 35px rgba(255, 107, 107, 0.7);
        }

        .call-float i {
            font-size: 2rem;
            color: var(--white);
        }

        /* SMS Float Button - Adjusted position */
        .sms-float {
            position: fixed;
            bottom: 50px; /* Adjusted position */
            right: 30px;
            width: 70px;
            height: 70px;
            background: #4a90e2;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(74, 144, 226, 0.5);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .sms-float:hover {
            transform: scale(1.15);
            box-shadow: 0 12px 35px rgba(74, 144, 226, 0.7);
        }

        .sms-float i {
            font-size: 2rem;
            color: var(--white);
        }

        /* Chat Button (Firebase for Admin) - Adjusted position */
        #chat-button {
            position: fixed;
            bottom: 5px; /* Adjusted position */
            right: 30px;
            width: 70px;
            height: 70px;
            background: var(--gradient-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(46, 125, 50, 0.4);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        #chat-button:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 35px rgba(46, 125, 50, 0.6);
        }

        #chat-button i {
            font-size: 2rem;
            color: var(--white);
        }

        /* Navigation */
        .navbar {
            background: rgba(26, 26, 26, 0.98) !important;
            backdrop-filter: blur(10px);
            padding: 20px 0;
            box-shadow: 0 2px 30px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .navbar.scrolled {
            padding: 10px 0;
        }

        .navbar-brand {
            font-size: 2rem;
            font-family: 'Cormorant Garamond', serif;
            font-weight: 700;
            background: linear-gradient(45deg, #2e7d32, #4caf50, #81c784);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 3px;
            text-shadow: none;
        }

        .nav-link {
            color: var(--white) !important;
            font-weight: 500;
            text-transform: uppercase;
            margin: 0 15px;
            font-size: 0.85rem;
            letter-spacing: 1px;
            position: relative;
            transition: all 0.3s ease;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            width: 0;
            height: 2px;
            background: var(--primary);
            transform: translateX(-50%);
            transition: width 0.3s ease;
        }

        .nav-link:hover::after {
            width: 80%;
        }

        .nav-link:hover {
            color: var(--primary) !important;
        }

        /* Hero Section */
        .hero-section {
            position: relative;
            height: 100vh;
            display: flex;
            align-items: center;
            overflow: hidden;
        }

        .hero-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.6)), 
                        url('https://images.unsplash.com/photo-1528605248644-14dd04022da1?q=80&w=2070');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            color: var(--white);
            text-align: center;
        }

        .hero-content h1 {
            font-size: 5rem;
            font-weight: 700;
            margin-bottom: 20px;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
            letter-spacing: 5px;
            background: linear-gradient(45deg, #fff, #4caf50);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero-content .subtitle {
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: 15px;
            letter-spacing: 8px;
            text-transform: uppercase;
        }

        .btn-primary-custom {
            background: var(--gradient-green);
            color: var(--white);
            padding: 18px 50px;
            border: none;
            font-weight: 600;
            font-size: 1rem;
            letter-spacing: 2px;
            text-transform: uppercase;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(46, 125, 50, 0.3);
            border-radius: 50px;
        }

        .btn-primary-custom:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(46, 125, 50, 0.5);
        }

        /* Sections General */
        .section-padding {
            padding: 100px 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 60px;
        }

        .section-title .subtitle {
            font-size: 1.1rem;
            color: var(--primary);
            margin-bottom: 10px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .section-title h2 {
            font-size: 3.5rem;
            font-weight: 700;
            color: var(--dark);
        }

        /* Menu Section */
        .menu-section {
            background: var(--light);
            padding: 120px 0;
        }

        .menu-categories {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 60px;
            flex-wrap: wrap;
        }

        .category-btn {
            background: var(--white);
            color: var(--dark);
            padding: 12px 30px;
            border: 2px solid var(--primary);
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .category-btn:hover,
        .category-btn.active {
            background: var(--primary);
            color: var(--white);
            transform: translateY(-2px);
        }

        .menu-item {
            background: var(--white);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 40px var(--shadow);
            transition: all 0.4s ease;
            height: 100%;
        }

        .menu-item:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.25);
        }

        .menu-item-image {
            position: relative;
            height: 250px;
            overflow: hidden;
        }

        .menu-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .menu-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--primary);
            color: var(--white);
            padding: 6px 15px;
            border-radius: 25px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .menu-item-content {
            padding: 25px;
        }

        .menu-price {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--light);
            padding: 5px 10px;
            border-radius: 25px;
        }

        .quantity-btn {
            background: var(--primary);
            color: var(--white);
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-weight: 700;
        }

        .add-to-cart-btn {
            background: var(--dark);
            color: var(--white);
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
        }

        .add-to-cart-btn:hover {
            background: var(--primary);
        }

        /* Cart Badge */
        .cart-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            background: var(--danger);
            color: var(--white);
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
        }

        /* Booking Section */
        .booking-section {
            background: var(--gradient-dark);
            color: var(--white);
        }

        .booking-section .subtitle {
            color: var(--primary);
        }

        .booking-form {
            background: var(--white);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3);
        }

        .booking-form .form-control,
        .booking-form .form-select {
            height: 55px;
            border-radius: 10px;
            border: 1px solid #ddd;
            padding: 0 20px;
            font-size: 1rem;
        }

        .booking-form .form-control:focus,
        .booking-form .form-select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 0.25rem rgba(46, 125, 50, 0.25);
        }

        .booking-form textarea.form-control {
            height: auto;
            padding-top: 15px;
        }

        /* Gallery Section */
        .gallery-section {
            background: var(--light);
        }

        .gallery-item {
            position: relative;
            overflow: hidden;
            border-radius: 15px;
            box-shadow: 0 8px 30px var(--shadow);
            cursor: pointer;
        }

        .gallery-item img {
            width: 100%;
            height: 300px;
            object-fit: cover;
            transition: transform 0.4s ease;
        }

        .gallery-item:hover img {
            transform: scale(1.1);
        }

        .gallery-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(46, 125, 50, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .gallery-item:hover .gallery-overlay {
            opacity: 1;
        }

        .gallery-overlay i {
            color: var(--white);
            font-size: 2.5rem;
        }

        /* Testimonials Section */
        .testimonials-section {
            background: var(--white);
        }

        .testimonial-card {
            background: var(--light);
            padding: 35px;
            border-radius: 20px;
            box-shadow: 0 10px 40px var(--shadow);
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .testimonial-stars {
            color: #ffc107;
            margin-bottom: 15px;
        }

        .testimonial-text {
            font-style: italic;
            margin-bottom: 20px;
            color: var(--text-dark);
        }

        .testimonial-author {
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .testimonial-position {
            font-size: 0.9rem;
            color: #666;
        }

        /* Features Section */
        .features-section {
            background: var(--light);
        }

        .feature-card {
            background: var(--white);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 40px var(--shadow);
            text-align: center;
            height: 100%;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
        }

        .feature-icon {
            width: 80px;
            height: 80px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px auto;
            font-size: 2.5rem;
            color: var(--white);
        }

        .feature-card h4 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: var(--dark);
        }

        .feature-card p {
            color: #555;
            line-height: 1.7;
        }

        /* Contact Section */
        #contact .section-title {
            color: var(--dark);
        }

        #contact .bg-dark {
            background: var(--dark) !important;
        }

        #contact .fa-map-marker-alt,
        #contact .fa-phone-alt,
        #contact .fa-whatsapp,
        #contact .fa-envelope {
            color: var(--primary);
        }

        /* Developer Section */
        .royal-font {
            font-family: 'Cormorant Garamond', serif;
        }

        /* Footer */
        footer {
            background: #1a1a1a;
            color: #f1f1f1;
            padding: 80px 0 30px 0;
            font-size: 0.9rem;
        }

        footer h5 {
            color: var(--primary);
            font-family: 'Cormorant Garamond', serif;
            font-weight: 700;
            margin-bottom: 25px;
            font-size: 1.5rem;
        }

        .footer-section p {
            color: #ccc;
            line-height: 1.8;
        }

        .footer-links {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .footer-links li {
            margin-bottom: 10px;
        }

        .footer-links a,
        .footer-links li {
            color: #ccc;
            text-decoration: none;
            transition: color 0.3s ease;
            display: flex;
            align-items: center;
        }

        .footer-links a:hover {
            color: var(--primary);
        }

        .footer-links i {
            margin-right: 10px;
            color: var(--primary);
        }

        .social-links a {
            color: var(--white);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            transition: all 0.3s ease;
        }

        .social-links a:hover {
            background: var(--primary);
            color: var(--white);
        }

        .copyright {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 25px;
            margin-top: 50px;
            text-align: center;
            color: #aaa;
        }

        /* Cart & Checkout Modals */
        #cartModal .modal-content,
        #checkoutModal .modal-content,
        #adminLoginModal .modal-content,
        #addEditMenuItemModal .modal-content,
        #adminChatModal .modal-content,
        #adminSettingsModal .modal-content,
        #userChatModal .modal-content {
            border-radius: 15px;
            overflow: hidden;
        }

        #cartModal .modal-header,
        #checkoutModal .modal-header,
        #adminLoginModal .modal-header,
        #addEditMenuItemModal .modal-header,
        #adminChatModal .modal-header,
        #adminSettingsModal .modal-header,
        #userChatModal .modal-header {
            background: var(--dark);
            color: var(--white);
            border-bottom: none;
        }

        #cartModal .modal-title,
        #checkoutModal .modal-title,
        #adminLoginModal .modal-title,
        #addEditMenuItemModal .modal-title,
        #adminChatModal .modal-title,
        #adminSettingsModal .modal-title,
        #userChatModal .modal-title {
            font-family: 'Cormorant Garamond', serif;
            font-weight: 700;
        }

        #cartModal .btn-close-white,
        #checkoutModal .btn-close-white,
        #adminLoginModal .btn-close-white,
        #addEditMenuItemModal .btn-close-white,
        #adminChatModal .btn-close-white,
        #adminSettingsModal .btn-close-white,
        #userChatModal .btn-close-white {
            filter: invert(1) grayscale(100%) brightness(200%); /* Makes btn-close white */
        }

        .cart-summary {
            background: var(--light);
            padding: 25px;
            border-radius: 15px;
        }

        .cart-summary span {
            font-weight: 500;
        }

        .cart-summary .total-price {
            font-weight: 700;
            font-size: 1.8rem;
            color: var(--primary);
        }

        .checkout-form .form-group {
            margin-bottom: 20px;
        }

        .checkout-form label {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--dark);
        }

        .checkout-form .form-control,
        .checkout-form .form-select {
            border-radius: 8px;
            height: 48px;
            font-size: 0.95rem;
            padding: 0 15px;
        }

        .checkout-form textarea.form-control {
            height: auto;
            padding-top: 12px;
        }

        .delivery-options {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }

        .delivery-option {
            flex: 1;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .delivery-option.active {
            border-color: var(--primary);
            background-color: var(--light);
            box-shadow: 0 5px 15px rgba(46, 125, 50, 0.1);
        }

        .delivery-option i {
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .delivery-option small {
            color: #777;
        }

        /* Admin Dashboard */
        .admin-panel {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--light);
            z-index: 10000;
            overflow-y: auto;
        }

        .admin-sidebar {
            width: 250px;
            background: var(--dark);
            color: var(--white);
            padding: 20px;
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            overflow-y: auto;
            z-index: 1000;
        }

        .admin-sidebar .nav-link {
            color: rgba(255, 255, 255, 0.8) !important;
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 5px;
            transition: all 0.2s ease;
        }

        .admin-sidebar .nav-link:hover,
        .admin-sidebar .nav-link.active {
            background: var(--primary);
            color: var(--white) !important;
        }

        .admin-content {
            margin-left: 250px;
            padding: 30px;
        }

        .admin-header {
            background: var(--gradient-dark);
            color: var(--white);
            padding: 30px;
            margin-bottom: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            position: sticky;
            top: 0;
            z-index: 999;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .stat-card {
            background: var(--white);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px var(--shadow);
            text-align: center;
        }

        .stat-card h2 {
            font-size: 3rem;
            margin-top: 10px;
        }

        .data-table {
            background: var(--white);
            border-radius: 15px;
            box-shadow: 0 5px 20px var(--shadow);
            padding: 20px;
        }

        .data-table .table {
            margin-bottom: 0;
        }

        .order-card, .message-card, .booking-card {
            background: var(--white);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px var(--shadow);
            margin-bottom: 20px;
            border-left: 5px solid var(--primary);
        }

        .order-card.unread, .message-card.unread {
            border-left: 5px solid var(--info);
            background-color: #eaf7f9; /* Light blue background for unread */
        }

        .order-card h5, .message-card h5, .booking-card h5 {
            color: var(--dark);
            font-weight: 700;
        }

        .order-card p, .message-card p, .booking-card p {
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .payment-screenshot {
            max-width: 200px;
            max-height: 200px;
            border-radius: 10px;
            margin-top: 15px;
            border: 1px solid #eee;
        }

        /* Menu Item Admin List */
        .admin-menu-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        .admin-menu-item:last-child {
            border-bottom: none;
        }
        .admin-menu-item img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 10px;
            margin-right: 15px;
        }

        /* Notification */
        .notification-toast {
            position: fixed;
            top: 100px;
            right: 30px;
            background: var(--white);
            padding: 20px 25px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            z-index: 10001;
            display: flex;
            align-items: center;
            gap: 15px;
            animation: slideInRight 0.4s ease;
            min-width: 300px;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(500px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Chat Modal Styles */
        #user-chat-messages, #adminChatModalBody {
            display: flex;
            flex-direction: column;
            height: 350px; /* Fixed height for chat window */
            overflow-y: auto;
            padding: 15px;
            background-color: #f8f9fa;
        }
        .chat-message {
            max-width: 70%;
            padding: 10px 15px;
            border-radius: 15px;
            margin-bottom: 10px;
            word-wrap: break-word;
        }
        .chat-message.sent {
            align-self: flex-end;
            background-color: var(--primary);
            color: white;
            border-bottom-right-radius: 2px;
        }
        .chat-message.received {
            align-self: flex-start;
            background-color: #e9ecef;
            color: var(--dark);
            border-bottom-left-radius: 2px;
        }
        .chat-timestamp {
            font-size: 0.75rem;
            color: #888;
            margin-top: 5px;
            text-align: right;
        }
        .chat-input-area {
            display: flex;
            padding: 15px;
            border-top: 1px solid #dee2e6;
            background-color: white;
        }
        #chatInput, #userChatMessageInput, #adminChatInput {
            flex-grow: 1;
            border-radius: 20px;
            padding: 10px 15px;
            border: 1px solid #ced4da;
        }
        #chatSendBtn, #userChatSendBtn, #adminChatSendBtn {
            margin-left: 10px;
            border-radius: 20px;
            padding: 10px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
        }
        .chat-header-user {
            font-weight: bold;
            color: var(--dark);
        }
        .message-card .read-status {
            font-size: 0.8em;
            color: #6c757d;
        }


        /* Responsive */
        @media (max-width: 991px) {
            .navbar-brand {
                font-size: 1.7rem;
            }
            .navbar-nav {
                text-align: center;
                margin-top: 20px;
            }
            .nav-link {
                margin: 10px 0;
            }
            .hero-content h1 {
                font-size: 3.5rem;
            }
            .hero-content .subtitle {
                font-size: 1.2rem;
                letter-spacing: 5px;
            }
            .btn-primary-custom {
                padding: 15px 35px;
            }
            .section-title h2 {
                font-size: 2.8rem;
            }
            .menu-categories {
                justify-content: flex-start;
                overflow-x: auto;
                padding-bottom: 10px;
                white-space: nowrap;
                flex-wrap: nowrap;
            }
            .menu-categories::-webkit-scrollbar {
                height: 5px;
            }
            .menu-categories::-webkit-scrollbar-thumb {
                background: var(--primary);
                border-radius: 5px;
            }
            .booking-section .booking-content {
                padding: 50px 0;
            }
            .booking-form {
                padding: 30px;
            }
            
            /* Mobile floating buttons arrangement - All on right side, adjusted spacing */
            .sticky-order-btn {
                bottom: 180px; /* Adjusted position */
                right: 20px;
                left: unset; /* Remove left property */
                transform: none; /* Remove transform property */
                padding: 15px 25px;
                font-size: 1rem;
            }
            .whatsapp-float { 
                bottom: 240px; /* Adjusted position */
                right: 20px; 
                width: 55px;
                height: 55px;
            }
            .call-float { 
                bottom: 120px; /* Adjusted position */
                right: 20px; 
                width: 55px;
                height: 55px;
            }
            .sms-float { 
                bottom: 60px; /* Adjusted position */
                right: 20px; 
                width: 55px;
                height: 55px;
            }
            #chat-button { 
                bottom: 0px; /* Adjusted position */
                right: 20px; 
                width: 55px;
                height: 55px;
            }
            .whatsapp-float i, .call-float i, .sms-float i, #chat-button i {
                font-size: 1.8rem;
            }

            .admin-sidebar {
                position: relative;
                width: 100%;
                height: auto;
            }
            .admin-content {
                margin-left: 0;
            }
            .admin-stats {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 576px) {
            .hero-content h1 {
                font-size: 2.5rem;
            }
            .hero-content .subtitle {
                font-size: 1rem;
                letter-spacing: 3px;
            }
            .section-title h2 {
                font-size: 2.2rem;
            }
            .menu-categories {
                justify-content: flex-start;
            }
            .category-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            /* Smallest mobile screens adjustment */
            .sticky-order-btn {
                bottom: 180px;
                right: 15px; /* Slightly more inward */
                font-size: 0.9rem;
                padding: 12px 25px;
            }
            .whatsapp-float { bottom: 240px; right: 15px; width: 50px; height: 50px; }
            .call-float { bottom: 120px; right: 15px; width: 50px; height: 50px; }
            .sms-float { bottom: 60px; right: 15px; width: 50px; height: 50px; }
            #chat-button { bottom: 0px; right: 15px; width: 50px; height: 50px; }
            .whatsapp-float i, .call-float i, .sms-float i, #chat-button i {
                font-size: 1.6rem;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loader"></div>
    </div>

    <!-- Sticky Order Button -->
    <button class="sticky-order-btn" onclick="scrollToMenu()">
        <i class="fas fa-utensils me-2"></i>ORDER NOW
    </button>

    <!-- WhatsApp Float Button -->
    <div class="whatsapp-float" onclick="openDirectWhatsApp()">
        <i class="fab fa-whatsapp"></i>
    </div>

    <!-- Call Float Button -->
    <div class="call-float" onclick="makeCall()">
        <i class="fas fa-phone-alt"></i>
    </div>

    <!-- SMS Float Button -->
    <div class="sms-float" onclick="sendSMS()">
        <i class="fas fa-sms"></i>
    </div>

    <!-- Chat Button (Firebase for Admin) -->
    <div id="chat-button" data-bs-toggle="modal" data-bs-target="#userChatModal">
        <i class="fas fa-comments"></i>
    </div>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#home">ZAYTOON GARDEN MULTAN</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#home">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#menu">Menu</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#features">Features</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#booking">Booking</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#gallery">Gallery</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#contact">Contact</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-warning" href="javascript:void(0)" onclick="showAdminLogin()">Admin</a>
                    </li>
                </ul>
                <div class="d-flex align-items-center gap-4">
                    <div class="position-relative" style="cursor: pointer;" data-bs-toggle="modal" data-bs-target="#cartModal">
                        <i class="fas fa-shopping-cart fa-lg text-white"></i>
                        <span class="cart-badge" id="cart-badge">0</span>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section" id="home">
        <div class="hero-bg"></div>
        <div class="container">
            <div class="hero-content">
                <div class="subtitle" data-aos="fade-up">Welcome to Excellence</div>
                <h1 data-aos="fade-up" data-aos-delay="200">ZAYTOON GARDEN</h1>
                <h2 style="color: white; font-size: 2.5rem;" data-aos="fade-up" data-aos-delay="300">MULTAN</h2>
                <p data-aos="fade-up" data-aos-delay="400">Order online and enjoy premium dining at your doorstep. Fast delivery, authentic taste, unbeatable quality.</p>
                <div class="d-flex gap-3 justify-content-center flex-wrap" data-aos="fade-up" data-aos-delay="600">
                    <button class="btn btn-primary-custom" onclick="scrollToMenu()">
                        <i class="fas fa-shopping-bag me-2"></i>Order Online
                    </button>
                    <a href="tel:+923188791637" class="btn btn-primary-custom" style="background: #ff6b6b;">
                        <i class="fas fa-phone me-2"></i>Call Now
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Menu Section -->
    <section class="menu-section" id="menu">
        <div class="container">
            <div class="text-center mb-5 section-title">
                <div class="subtitle" style="color: var(--primary);">Our Delicious Menu</div>
                <h2>Order Your Favorites</h2>
            </div>
            
            <div class="menu-categories">
                <button class="category-btn active" data-category="all">All Items</button>
                <button class="category-btn" data-category="fast-food">Fast Food</button>
                <button class="category-btn" data-category="main">Main Course</button>
                <button class="category-btn" data-category="bbq">BBQ</button>
                <button class="category-btn" data-category="pizza">Pizza</button>
                <button class="category-btn" data-category="dessert">Desserts</button>
                <button class="category-btn" data-category="drinks">Drinks</button>
                <button class="category-btn" data-category="sweets">Sweets</button> <!-- Added Sweets Category -->
            </div>

            <div class="row g-4" id="menu-container">
                <!-- Menu items loaded by JavaScript -->
            </div>
        </div>
    </section>
    
    <!-- Booking Section -->
    <section class="booking-section section-padding" id="booking">
        <div class="container booking-content">
            <div class="row align-items-center">
                <div class="col-lg-5 mb-5 mb-lg-0">
                    <div data-aos="fade-right">
                        <div class="subtitle" style="color: var(--primary);">Reserve Your Spot</div>
                        <h2 class="display-4 fw-bold mb-4">Book Your Table</h2>
                        <p class="mb-4 text-white-50">Experience fine dining in our exclusive private cabins or elegant main hall. Book your table now and enjoy a memorable dining experience with your loved ones.</p>
                        <div class="d-flex align-items-center mb-4">
                            <div style="width: 60px; height: 60px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 20px;">
                                <i class="fas fa-phone-alt fa-lg text-white"></i>
                            </div>
                            <div>
                                <h6 class="mb-1 text-white">Call for Reservations</h6>
                                <h5 style="color: var(--primary); font-weight: 700;" id="booking-call-number">+92 318 8791637</h5>
                            </div>
                        </div>
                        <div class="d-flex align-items-center">
                            <div style="width: 60px; height: 60px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 20px;">
                                <i class="fas fa-map-marker-alt fa-lg text-white"></i>
                            </div>
                            <div>
                                <h6 class="mb-1 text-white">Visit Us At</h6>
                                <p class="mb-0 text-white-50">Larr Ada, Multan Road, Pakistan</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-7">
                    <div class="booking-form" data-aos="fade-left">
                        <form id="booking-form">
                            <div class="row g-4">
                                <div class="col-md-6">
                                    <input type="text" class="form-control" id="booking-name" placeholder="Full Name" required>
                                </div>
                                <div class="col-md-6">
                                    <input type="tel" class="form-control" id="booking-phone" placeholder="Phone Number" required>
                                </div>
                                <div class="col-md-6">
                                    <input type="email" class="form-control" id="booking-email" placeholder="Email Address" required>
                                </div>
                                <div class="col-md-6">
                                    <input type="date" class="form-control" id="booking-date" required>
                                </div>
                                <div class="col-md-6">
                                    <input type="time" class="form-control" id="booking-time" required>
                                </div>
                                <div class="col-md-6">
                                    <select class="form-select" id="booking-guests" required>
                                        <option value="">Number of Guests</option>
                                        <option value="2">2 Persons</option>
                                        <option value="4">4 Persons</option>
                                        <option value="6">6 Persons</option>
                                        <option value="8">8+ Persons (Family Cabin)</option>
                                    </select>
                                </div>
                                <div class="col-12">
                                    <textarea class="form-control" id="booking-message" rows="3" placeholder="Special Requests (Optional)"></textarea>
                                </div>
                                <div class="col-12">
                                    <div class="alert" style="background: rgba(46, 125, 50, 0.1); border: 1px solid var(--primary); color: var(--primary);">
                                        <i class="fas fa-info-circle me-2"></i>
                                        Booking Fee: Rs. 1,000 (Advance Payment Required)
                                    </div>
                                </div>
                                <div class="col-12">
                                    <button type="submit" class="btn btn-primary-custom w-100">
                                        <i class="fas fa-calendar-check me-2"></i>Confirm Reservation
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Gallery Section -->
    <section class="gallery-section section-padding" id="gallery">
        <div class="container">
            <div class="section-title">
                <div class="subtitle">Visual Journey</div>
                <h2>Our Gallery</h2>
            </div>
            <div class="row g-4">
                <div class="col-md-4" data-aos="zoom-in" data-aos-delay="100">
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?q=80&w=2070" alt="Dish">
                        <div class="gallery-overlay">
                            <i class="fas fa-search-plus"></i>
                        </div>
                    </div>
                </div>
                <div class="col-md-4" data-aos="zoom-in" data-aos-delay="200">
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1555396273-367ea4eb4db5?q=80&w=2074" alt="Restaurant">
                        <div class="gallery-overlay">
                            <i class="fas fa-search-plus"></i>
                        </div>
                    </div>
                </div>
                <div class="col-md-4" data-aos="zoom-in" data-aos-delay="300">
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1559339352-11d035aa65de?q=80&w=2074" alt="Interior">
                        <div class="gallery-overlay">
                            <i class="fas fa-search-plus"></i>
                        </div>
                    </div>
                </div>
                <div class="col-md-6" data-aos="zoom-in" data-aos-delay="400">
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?q=80&w=2081" alt="Food">
                        <div class="gallery-overlay">
                            <i class="fas fa-search-plus"></i>
                        </div>
                    </div>
                </div>
                <div class="col-md-6" data-aos="zoom-in" data-aos-delay="500">
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?q=80&w=2070" alt="Dining">
                        <div class="gallery-overlay">
                            <i class="fas fa-search-plus"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section class="testimonials-section section-padding">
        <div class="container">
            <div class="section-title">
                <div class="subtitle">What Our Guests Say</div>
                <h2>Testimonials</h2>
            </div>
            <div class="row g-4">
                <div class="col-md-4" data-aos="fade-up" data-aos-delay="100">
                    <div class="testimonial-card">
                        <div class="testimonial-stars">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <p class="testimonial-text">"The best dining experience in Multan! The food quality is exceptional and the service is outstanding. Highly recommended for family gatherings."</p>
                        <h5 class="testimonial-author">Ahmed Khan</h5>
                        <p class="testimonial-position">Regular Customer</p>
                    </div>
                </div>
                <div class="col-md-4" data-aos="fade-up" data-aos-delay="200">
                    <div class="testimonial-card">
                        <div class="testimonial-stars">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <p class="testimonial-text">"Absolutely love their traditional karahi and BBQ items. The ambiance is perfect for special occasions. Will definitely visit again!"</p>
                        <h5 class="testimonial-author">Fatima Ali</h5>
                        <p class="testimonial-position">Food Enthusiast</p>
                    </div>
                </div>
                <div class="col-md-4" data-aos="fade-up" data-aos-delay="300">
                    <div class="testimonial-card">
                        <div class="testimonial-stars">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <p class="testimonial-text">"Premium quality food with excellent taste. The staff is very professional and courteous. Best restaurant for corporate dinners."</p>
                        <h5 class="testimonial-author">Hassan Raza</h5>
                        <p class="testimonial-position">Business Professional</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features-section section-padding" id="features">
        <div class="container">
            <div class="section-title">
                <div class="subtitle">Why Choose Us</div>
                <h2>Premium Services</h2>
            </div>
            <div class="row g-4">
                <div class="col-lg-4" data-aos="fade-up" data-aos-delay="100">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-utensils"></i>
                        </div>
                        <h4>Exquisite Cuisine</h4>
                        <p>Our master chefs create culinary masterpieces using the finest ingredients, blending traditional recipes with modern techniques.</p>
                    </div>
                </div>
                <div class="col-lg-4" data-aos="fade-up" data-aos-delay="200">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-crown"></i>
                        </div>
                        <h4>Royal Ambiance</h4>
                        <p>Immerse yourself in an elegant atmosphere designed for comfort and luxury, perfect for family dinners and special occasions.</p>
                    </div>
                </div>
                <div class="col-lg-4" data-aos="fade-up" data-aos-delay="300">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-concierge-bell"></i>
                        </div>
                        <h4>Premium Service</h4>
                        <p>Our dedicated staff ensures every guest receives personalized attention and an unforgettable dining experience.</p>
                    </div>
                </div>
                <div class="col-lg-4" data-aos="fade-up" data-aos-delay="400">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-motorcycle"></i>
                        </div>
                        <h4>Fast Delivery</h4>
                        <p>Enjoy our premium dishes at home with our efficient delivery service that maintains quality and temperature.</p>
                    </div>
                </div>
                <div class="col-lg-4" data-aos="fade-up" data-aos-delay="500">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h4>Quality Guaranteed</h4>
                        <p>We maintain the highest standards of food safety and hygiene, ensuring every dish meets our excellence criteria.</p>
                    </div>
                </div>
                <div class="col-lg-4" data-aos="fade-up" data-aos-delay="600">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-heart"></i>
                        </div>
                        <h4>Made with Love</h4>
                        <p>Every dish is prepared with passion and care, bringing you authentic flavors that touch your heart.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact & Location Section -->
    <section class="section-padding bg-white" id="contact">
        <div class="container">
            <div class="section-title">
                <div class="subtitle">Visit Our Venue</div>
                <h2>Find Us In Multan</h2>
            </div>
            <div class="row g-0 shadow-lg rounded-4 overflow-hidden">
                <!-- Contact Info Column -->
                <div class="col-lg-4 bg-dark p-5 d-flex flex-column justify-content-center">
                    <h3 class="text-white mb-4 royal-font">Get In Touch</h3>
                    <div class="d-flex align-items-center mb-4">
                        <div style="width: 50px; height: 50px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                            <i class="fas fa-map-marker-alt text-white"></i>
                        </div>
                        <div class="text-white">
                            <h6 class="mb-0">Address</h6>
                            <p class="mb-0 small opacity-75">BHW Road, Multan , Pakistan</p>
                        </div>
                    </div>
                    <div class="d-flex align-items-center mb-4">
                        <div style="width: 50px; height: 50px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                            <i class="fas fa-phone-alt text-white"></i>
                        </div>
                        <div class="text-white">
                            <h6 class="mb-0">Phone</h6>
                            <p class="mb-0 small opacity-75" id="contact-phone">+92 318 8791637</p>
                        </div>
                    </div>
                    <div class="d-flex align-items-center">
                        <div style="width: 50px; height: 50px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                            <i class="fas fa-envelope text-white"></i>
                        </div>
                        <div class="text-white">
                            <h6 class="mb-0">Email</h6>
                            <p class="mb-0 small opacity-75">info@zaytoon.com</p>
                        </div>
                    </div>
                </div>
                <!-- Map Column -->
                <div class="col-lg-8" style="min-height: 450px;">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3451.729211618593!2d71.49176077534725!3d30.10194067489465!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x393b3976ac703765%3A0x6ea9198153dff46!2zWmF5dG9vbiBHYXJkZW4gUmVzdGF1cmFudCBNdWx0YW4g2LLbjNiq2YjZhiDar9in2LHaiNmGINix24zYs9m52YjYsdmG2bkg2YXZhNiq2KfZhg!5e0!3m2!1sen!2s!4v1768095610612!5m2!1sen!2s" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Subscribe Section -->
    <section class="subscribe-section section-padding" style="background-color: var(--light);" id="subscribe">
        <div class="container text-center" data-aos="fade-up">
            <div class="section-title">
                <div class="subtitle">Stay Updated</div>
                <h2>Get Notified for New Menu Items!</h2>
                <p class="lead text-muted">Be the first to know about our latest delicious additions and special offers.</p>
            </div>
            <button class="btn btn-primary-custom" id="subscribe-button">
                <i class="fas fa-bell me-2"></i> Subscribe for Updates
            </button>
            <p id="subscription-status" class="mt-3 text-muted"></p>
        </div>
    </section>

    <!-- Developer Section: Muhammad Umair -->
    <section class="section-padding" style="background: #0f0f0f; color: #ffffff; border-top: 2px solid var(--primary);">
        <div class="container">
            <div class="row align-items-center">
                <!-- Text Side -->
                <div class="col-lg-6 mb-4 mb-lg-0" data-aos="fade-right">
                    <div class="subtitle" style="color: var(--primary); letter-spacing: 3px; font-weight: 600; text-transform: uppercase; margin-bottom: 15px;">Digital Architect</div>
                    <h2 class="display-5 fw-bold royal-font mb-4" style="color: var(--white);">Developed by <br><span style="color: var(--primary);">Muhammad Umair & Team</span></h2>
                    <p class="text-secondary mb-4" style="line-height: 1.8; font-size: 1.1rem;">
                        This premium digital experience was conceptualized and crafted with excellence by Muhammad Umair. Specializing in 7-star restaurant solutions, ensuring every pixel reflects luxury and tradition.
                    </p>
                </div>
                <!-- Contact Side -->
                <div class="col-lg-6" data-aos="fade-left">
                    <div class="p-5 rounded-4 shadow-lg" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(212, 165, 116, 0.2);">
                        <h4 class="royal-font mb-4" style="color: var(--primary);">Contact Developer</h4>
                        
                        <div class="d-flex align-items-center mb-4">
                            <div style="width: 45px; height: 45px; background: rgba(212, 165, 116, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                                <i class="fas fa-phone-alt text-primary"></i>
                            </div>
                            <div>
                                <h6 class="mb-0 text-white">Umair Amir</h6>
                                <p class="mb-0 small text-secondary">+92 304 9472735</p>
                            </div>
                        </div>

                        <div class="d-flex align-items-center mb-4">
                            <div style="width: 45px; height: 45px; background: rgba(37, 211, 102, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                                <i class="fab fa-whatsapp text-success"></i>
                            </div>
                            <div>
                                <h6 class="mb-0 text-white">Ayesha Malik (WhatsApp)</h6>
                                <p class="mb-0 small text-secondary">+92 3184195665</p>
                            </div>
                        </div>

                        <div class="d-flex align-items-center">
                            <div style="width: 45px; height: 45px; background: rgba(231, 76, 60, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                                <i class="fas fa-envelope text-danger"></i>
                            </div>
                            <div>
                                <h6 class="mb-0 text-white">Email Support</h6>
                                <p class="mb-0 small text-secondary">muhammadumairamir12@gmail.com</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-4 footer-section mb-4 mb-lg-0">
                    <h5>zytoon Restaurant</h5>
                    <p class="text-light">Experience the finest culinary journey with our premium dining experience. We serve excellence on every plate.</p>
                    <div class="social-links">
                        <a href="https://www.facebook.com/zaytoongardenrestaurant" target="_blank" class="social-link"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://www.instagram.com/zaytoongarden_restaurant/" target="_blank" class="social-link"><i class="fab fa-instagram"></i></a>
                        <a href="https://www.tiktok.com/@zaytoongardenmultan" target="_blank" class="social-link"><i class="fab fa-tiktok"></i></a> <!-- Added TikTok -->
                        <a href="https://www.youtube.com/@zaytoongardenrestaurant" target="_blank" class="social-link"><i class="fab fa-youtube"></i></a> <!-- Added YouTube -->
                        <a href="https://wa.me/923188791637" target="_blank" class="social-link"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="col-lg-2 footer-section mb-4 mb-lg-0">
                    <h5>Quick Links</h5>
                    <ul class="footer-links">
                        <li><a href="#home">Home</a></li>
                        <li><a href="#menu">Menu</a></li>
                        <li><a href="#booking">Booking</a></li>
                        <li><a href="#gallery">Gallery</a></li>
                        <li><a href="#contact">Contact</a></li>
                        <li><a href="https://zaytoongarden.com/menu" target="_blank">Full Menu</a></li> <!-- Added Menu Link -->
                    </ul>
                </div>
                <div class="col-lg-3 footer-section mb-4 mb-lg-0">
                    <h5>Contact Info</h5>
                    <ul class="footer-links">
                        <li><i class="fas fa-map-marker-alt me-2"></i> BUW Road, Multan </li>
                        <li><i class="fas fa-phone me-2"></i> <span id="footer-phone-number">+92 318 8791637</span></li>
                        <li><i class="fas fa-envelope me-2"></i> <a href="mailto:zaytoongarden@gmail.com">zaytoongarden@gmail.com</a></li> <!-- Added Email Link -->
                    </ul>
                </div>
                <div class="col-lg-3 footer-section">
                    <h5>Opening Hours</h5>
                    <ul class="footer-links">
                        <li>Monday - Friday: 11:00 AM - 11:00 PM</li>
                        <li>Saturday - Sunday: 10:00 AM - 12:00 AM</li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2026 ZAYTOON Restaurant. All Rights Reserved. Developed with Excellence.</p>
            </div>
        </div>
    </footer>
    

    <!-- Cart Modal -->
    <div class="modal fade" id="cartModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header bg-dark text-white">
                    <h5 class="modal-title"><i class="fas fa-shopping-cart me-2"></i>Your Cart</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-0" id="cart-items-container"></div>
                <div class="modal-footer d-block">
                    <div class="cart-summary" style="background: var(--light); padding: 25px; border-radius: 15px;">
                        <div class="d-flex justify-content-between mb-3">
                            <span>Subtotal:</span>
                            <span id="cart-subtotal">Rs. 0</span>
                        </div>
                        <div class="d-flex justify-content-between mb-3">
                            <span>Delivery:</span>
                            <span id="delivery-charges">Rs. 0</span>
                        </div>
                        <div class="d-flex justify-content-between border-top pt-3" style="font-weight: 700; font-size: 1.5rem; color: var(--primary);">
                            <span>Total:</span>
                            <span id="cart-total">Rs. 0</span>
                        </div>
                    </div>
                    <button class="btn btn-primary-custom w-100 mt-3" onclick="proceedToCheckout()">
                        <i class="fas fa-arrow-right me-2"></i>Proceed to Checkout
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div class="modal fade" id="checkoutModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-dark text-white">
                    <h5 class="modal-title"><i class="fas fa-file-invoice me-2"></i>Checkout</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form class="checkout-form" id="checkout-form">
                        <div class="mb-3">
                            <label class="form-label fw-bold">Full Name *</label>
                            <input type="text" class="form-control" id="customer-name" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-bold">Mobile Number *</label>
                            <input type="tel" class="form-control" id="customer-phone" required placeholder="+92 3XX XXXXXXX">
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-bold">Email (Optional)</label>
                            <input type="email" class="form-control" id="customer-email">
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-bold">Delivery Option *</label>
                            <div class="delivery-options">
                                <div class="delivery-option active" data-option="delivery" onclick="setDeliveryOption('delivery')">
                                    <i class="fas fa-motorcycle"></i>
                                    <div><strong>Home Delivery</strong></div>
                                    <small>Rs. 150</small>
                                </div>
                                <div class="delivery-option" data-option="pickup" onclick="setDeliveryOption('pickup')">
                                    <i class="fas fa-store"></i>
                                    <div><strong>Self Pickup</strong></div>
                                    <small>Free</small>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3" id="address-group">
                            <label class="form-label fw-bold">Delivery Address *</label>
                            <textarea class="form-control" id="customer-address" rows="3" required placeholder="House/Street, Area, Landmark"></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-bold">Order Notes (Optional)</label>
                            <textarea class="form-control" id="order-notes" rows="2" placeholder="Any special instructions..."></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label fw-bold">Payment Method *</label>
                            <select class="form-select" id="payment-method" required>
                                <option value="cod">Cash on Delivery</option>
                                <option value="jazzcash">JazzCash</option>
                                <option value="easypaisa">EasyPaisa</option>
                                <option value="bank">Bank Transfer</option>
                            </select>
                        </div>
                        <div id="payment-details" style="display: none;" class="mb-3">
                            <div class="alert alert-info">
                                <h6 class="fw-bold">Payment Details:</h6>
                                <p class="mb-2">
                                    <strong>JazzCash:</strong> <span id="checkout-jazzcash-num">0304-9472735</span> 
                                    <button type="button" class="btn btn-sm btn-outline-primary ms-2" onclick="copyToClipboard('checkout-jazzcash-num')">Copy</button>
                                </p>
                                <p class="mb-2">
                                    <strong>EasyPaisa:</strong> <span id="checkout-easypaisa-num">0318-8791637</span> 
                                    <button type="button" class="btn btn-sm btn-outline-primary ms-2" onclick="copyToClipboard('checkout-easypaisa-num')">Copy</button>
                                </p>
                                <p class="mb-2"><strong>Bank Account:</strong></p>
                                <p class="mb-1">
                                    Account No: <span id="checkout-bank-acc-no">1234567890</span> 
                                    <button type="button" class="btn btn-sm btn-outline-primary ms-2" onclick="copyToClipboard('checkout-bank-acc-no')">Copy</button>
                                </p>
                                <p class="mb-1">Account Holder: <span id="checkout-bank-acc-holder">Zaytoon Garden</span></p>
                                <p class="mb-0">Bank: <span id="checkout-bank-name">HBL</span></p>
                            </div>
                            <label class="form-label fw-bold">Upload Payment Screenshot *</label>
                            <input type="file" class="form-control" id="payment-screenshot" accept="image/*">
                        </div>
                        <button type="submit" class="btn btn-primary-custom w-100">
                            <i class="fas fa-check-circle me-2"></i>Place Order
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div class="modal fade" id="adminLoginModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-dark text-white">
                    <h5 class="modal-title">Admin Login</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="admin-login-form">
                        <div class="mb-3">
                            <input type="email" class="form-control" id="admin-email" placeholder="Email" required>
                        </div>
                        <div class="mb-3">
                            <input type="password" class="form-control" id="admin-password" placeholder="Password" required>
                        </div>
                        <button type="submit" class="btn btn-primary-custom w-100">Login</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- User Chat Modal -->
    <div class="modal fade" id="userChatModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-dark text-white">
                    <h5 class="modal-title"><i class="fas fa-comments me-2"></i>Zaytoon Garden Chat</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="user-chat-messages" style="height: 350px; overflow-y: auto; background-color: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <!-- User's chat messages will be loaded here -->
                    </div>
                    <div class="mt-3 d-flex">
                        <input type="text" class="form-control" id="userChatMessageInput" placeholder="Type your message...">
                        <button class="btn btn-primary-custom ms-2" id="userChatSendBtn">Send</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div class="admin-panel" id="admin-panel">
        <div class="admin-sidebar">
            <h4 class="text-white text-center mb-4 pt-3 royal-font">Admin Panel</h4>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link active" href="#dashboard-overview" onclick="showAdminSection('dashboard-overview')">
                        <i class="fas fa-tachometer-alt me-2"></i> Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#admin-orders-list" onclick="showAdminSection('admin-orders-list')">
                        <i class="fas fa-receipt me-2"></i> Orders
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#admin-menu-management" onclick="showAdminSection('admin-menu-management')">
                        <i class="fas fa-utensils me-2"></i> Menu Management
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#admin-bookings-list" onclick="showAdminSection('admin-bookings-list')">
                        <i class="fas fa-calendar-alt me-2"></i> Bookings
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#admin-messages-list" onclick="showAdminSection('admin-messages-list')">
                        <i class="fas fa-comments me-2"></i> Messages (<span id="unread-messages-badge">0</span> Unread)
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#admin-settings" onclick="showAdminSection('admin-settings')">
                        <i class="fas fa-cogs me-2"></i> Settings
                    </a>
                </li>
                <li class="nav-item mt-3">
                    <button class="btn btn-outline-light w-100" onclick="adminLogout()">
                        <i class="fas fa-sign-out-alt me-2"></i> Logout
                    </button>
                </li>
            </ul>
        </div>
        <div class="admin-content">
            <div class="admin-header">
                <div class="d-flex justify-content-between align-items-center">
                    <h2>Admin Dashboard - Zaytoon Garden</h2>
                    <button class="btn btn-outline-light" onclick="closeAdmin()">
                        <i class="fas fa-times me-2"></i>Exit
                    </button>
                </div>
            </div>

            <!-- Dashboard Overview Section -->
            <div id="dashboard-overview" class="admin-section active">
                <div class="admin-stats">
                    <div class="stat-card">
                        <h6 class="text-muted">Total Orders</h6>
                        <h2 class="text-success" id="total-orders">0</h2>
                    </div>
                    <div class="stat-card">
                        <h6 class="text-muted">Pending Orders</h6>
                        <h2 class="text-warning" id="pending-orders">0</h2>
                    </div>
                    <div class="stat-card">
                        <h6 class="text-muted">Completed Orders</h6>
                        <h2 class="text-primary" id="completed-orders">0</h2>
                    </div>
                    <div class="stat-card">
                        <h6 class="text-muted">Total Revenue</h6>
                        <h2 class="text-success" id="total-revenue">Rs. 0</h2>
                    </div>
                    <div class="stat-card">
                        <h6 class="text-muted">Total Bookings</h6>
                        <h2 class="text-info" id="total-bookings">0</h2>
                    </div>
                    <div class="stat-card">
                        <h6 class="text-muted">New Messages</h6>
                        <h2 class="text-danger" id="new-messages">0</h2>
                    </div>
                </div>
                <h3 class="mb-4">Recent Orders</h3>
                <div id="admin-orders-recent"></div>
            </div>

            <!-- Admin Orders List Section -->
            <div id="admin-orders-list" class="admin-section">
                <h3 class="mb-4">All Orders</h3>
                <div id="admin-orders-full"></div>
            </div>

            <!-- Admin Menu Management Section -->
            <div id="admin-menu-management" class="admin-section">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3>Menu Items</h3>
                    <button class="btn btn-primary-custom" data-bs-toggle="modal" data-bs-target="#addEditMenuItemModal" onclick="prepareMenuItemForm()">
                        <i class="fas fa-plus me-2"></i>Add New Item
                    </button>
                </div>
                <div class="data-table">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Image</th>
                                <th>Name</th>
                                <th>Category</th>
                                <th>Price</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="admin-menu-items-table">
                            <!-- Menu items will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Admin Bookings List Section -->
            <div id="admin-bookings-list" class="admin-section">
                <h3 class="mb-4">Table Bookings</h3>
                <div id="admin-bookings-container"></div>
            </div>

            <!-- Admin Messages List Section -->
            <div id="admin-messages-list" class="admin-section">
                <h3 class="mb-4">Customer Messages</h3>
                <div id="admin-messages-container"></div>
            </div>

            <!-- Admin Settings Section -->
            <div id="admin-settings" class="admin-section">
                <h3 class="mb-4">Website Settings</h3>

                <div class="card mb-4">
                    <div class="card-header bg-dark text-white">Contact Numbers</div>
                    <div class="card-body">
                        <form id="contact-numbers-form">
                            <div class="mb-3">
                                <label for="setting-whatsapp-num" class="form-label">WhatsApp Number</label>
                                <input type="text" class="form-control" id="setting-whatsapp-num" placeholder="+92XXXXXXXXXX">
                            </div>
                            <div class="mb-3">
                                <label for="setting-call-num" class="form-label">Call Number</label>
                                <input type="text" class="form-control" id="setting-call-num" placeholder="+92XXXXXXXXXX">
                            </div>
                            <div class="mb-3">
                                <label for="setting-sms-num" class="form-label">SMS Number</label>
                                <input type="text" class="form-control" id="setting-sms-num" placeholder="+92XXXXXXXXXX">
                            </div>
                            <button type="submit" class="btn btn-primary-custom">Save Contact Numbers</button>
                        </form>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-header bg-dark text-white">Payment Account Details</div>
                    <div class="card-body">
                        <form id="payment-details-form">
                            <div class="mb-3">
                                <label for="setting-jazzcash-num" class="form-label">JazzCash Number</label>
                                <input type="text" class="form-control" id="setting-jazzcash-num" placeholder="03XXXXXXXXX">
                            </div>
                            <div class="mb-3">
                                <label for="setting-easypaisa-num" class="form-label">EasyPaisa Number</label>
                                <input type="text" class="form-control" id="setting-easypaisa-num" placeholder="03XXXXXXXXX">
                            </div>
                            <div class="mb-3">
                                <label for="setting-bank-acc-no" class="form-label">Bank Account Number</label>
                                <input type="text" class="form-control" id="setting-bank-acc-no" placeholder="XXXXXXXXXXXXXX">
                            </div>
                            <div class="mb-3">
                                <label for="setting-bank-acc-holder" class="form-label">Bank Account Holder Name</label>
                                <input type="text" class="form-control" id="setting-bank-acc-holder" placeholder="Account Holder Name">
                            </div>
                            <div class="mb-3">
                                <label for="setting-bank-name" class="form-label">Bank Name</label>
                                <input type="text" class="form-control" id="setting-bank-name" placeholder="Bank Name (e.g., HBL)">
                            </div>
                            <button type="submit" class="btn btn-primary-custom">Save Payment Details</button>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header bg-dark text-white">Auto-Reply Message (for new chat messages)</div>
                    <div class="card-body">
                        <form id="auto-reply-form">
                            <div class="mb-3">
                                <textarea class="form-control" id="setting-auto-reply" rows="3" placeholder="Thank you for your message! We will get back to you shortly."></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary-custom">Save Auto-Reply</button>
                        </form>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Add/Edit Menu Item Modal -->
    <div class="modal fade" id="addEditMenuItemModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-dark text-white">
                    <h5 class="modal-title" id="addEditMenuItemModalLabel">Add New Menu Item</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="menu-item-form">
                        <input type="hidden" id="menu-item-id">
                        <div class="mb-3">
                            <label for="menu-item-name" class="form-label">Item Name</label>
                            <input type="text" class="form-control" id="menu-item-name" required>
                        </div>
                        <div class="mb-3">
                            <label for="menu-item-description" class="form-label">Description</label>
                            <textarea class="form-control" id="menu-item-description" rows="2" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="menu-item-price" class="form-label">Price (Rs.)</label>
                            <input type="number" class="form-control" id="menu-item-price" required min="0">
                        </div>
                        <div class="mb-3">
                            <label for="menu-item-category" class="form-label">Category</label>
                            <select class="form-select" id="menu-item-category" required>
                                <option value="">Select Category</option>
                                <option value="fast-food">Fast Food</option>
                                <option value="main">Main Course</option>
                                <option value="bbq">BBQ</option>
                                <option value="pizza">Pizza</option>
                                <option value="dessert">Desserts</option>
                                <option value="drinks">Drinks</option>
                                <option value="sweets">Sweets</option> <!-- Added Sweets Category -->
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="menu-item-image-url" class="form-label">Image URL (Optional, paste link)</label>
                            <input type="url" class="form-control" id="menu-item-image-url" placeholder="https://example.com/image.jpg">
                            <small class="text-muted">Or upload an image:</small>
                        </div>
                        <div class="mb-3">
                            <label for="menu-item-image-upload" class="form-label">Upload Image (Optional)</label>
                            <input type="file" class="form-control" id="menu-item-image-upload" accept="image/*">
                            <small class="text-muted" id="current-image-preview"></small>
                        </div>
                        <button type="submit" class="btn btn-primary-custom w-100">Save Item</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Chat Modal -->
    <div class="modal fade" id="adminChatModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-dark text-white">
                    <h5 class="modal-title"><i class="fas fa-comments me-2"></i>Chat with <span id="chat-user-name"></span></h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-0">
                    <div id="adminChatModalBody">
                        <!-- Admin Chat messages will be loaded here -->
                    </div>
                    <div class="chat-input-area">
                        <input type="text" class="form-control" id="adminChatInput" placeholder="Type your message...">
                        <button class="btn btn-primary-custom" id="adminChatSendBtn">Send</button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, updateDoc, doc, deleteDoc, getDoc, setDoc, serverTimestamp, arrayUnion, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL, deleteObject } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

        // IMPORTANT: Replace these with your actual Firebase project configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA6jYns24BirjdQEE7FBAKMp_JykjYCYhQ", // Replace with your Firebase API Key
            authDomain: "zaytoon-cf818.firebaseapp.com",       // Replace with your Firebase Auth Domain
            projectId: "zaytoon-cf818",                        // Replace with your Firebase Project ID
            storageBucket: "zaytoon-cf818.firebasestorage.app", // Replace with your Firebase Storage Bucket
            messagingSenderId: "349904367392",                 // Replace with your Firebase Messaging Sender ID
            appId: "1:349904367392:web:6b5f66eb020f09d89e7145"   // Replace with your Firebase App ID
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app); 
        let currentUserChatId = null; // To store the chat ID for the currently open admin chat modal

        let menuItemsData = []; // To store live menu items from Firebase
        let cart = [];
        let deliveryOption = 'delivery'; // Default delivery option
        let adminLoggedIn = false;
        let frontendContactNumbers = {};
        let frontendPaymentDetails = {};
        let autoReplyMessage = "";

        // Yahan par aapki di hui menu items ki list shamil ki gayi hai
        // IMPORTANT: Saari IDs ko unique kar diya gaya hai.
        const initialMenuItemsToSeed = [
            { id: "1", name: "Zinger Burger", price: 850, category: "fast-food", description: "Crispy chicken fillet", image: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=500" },
            { id: "2", name: "Chicken Pizza", price: 1950, category: "pizza", description: "Large chicken pizza", image: "https://images.unsplash.com/photo-1513104890138-7c749659a591?w=500" },
            { id: "3", name: "Mutton Karahi", price: 2900, category: "main", description: "Traditional karahi", image: "https://images.unsplash.com/photo-1603894584373-5ac82b2ae398?w=500" },
            { id: "4", name: "Chicken Karahi", price: 2400, category: "main", description: "Fresh chicken karahi", image: "https://images.unsplash.com/photo-1610057099443-fde8c4d50f91?w=500" },
            { id: "5", name: "Seekh Kabab", price: 1400, category: "bbq", description: "Grilled kebabs", image: "https://images.unsplash.com/photo-1599487488170-d11ec9c172f0?w=500" },
            { id: "6", name: "Chicken Tikka", price: 1200, category: "bbq", description: "Marinated chicken", image: "https://images.unsplash.com/photo-1599487488170-d11ec9c172f0?w=500" },
            { id: "7", name: "Lava Cake", price: 750, category: "dessert", description: "Chocolate cake", image: "https://images.unsplash.com/photo-1606313564200-e75d5e30476c?w=500" },
            { id: "8", name: "Mint Margarita", price: 350, category: "drinks", description: "Refreshing drink", image: "https://images.unsplash.com/photo-1546173159-315724a31696?w=500" },
            { id: "9", name: "Club Sandwich Max", price: 750, category: "fast-food", description: "Triple decker sandwich with chicken and vegetables", image: "https://images.pexels.com/photos/1600727/pexels-photo-1600727.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "10", name: "Chicken Biryani Full", price: 950, category: "main", description: "Aromatic basmati rice with tender chicken", image: "https://images.pexels.com/photos/7394851/pexels-photo-7394851.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "11", name: "Chicken Tikka BBQ", price: 1600, category: "bbq", description: "Marinated chicken pieces grilled to perfection", image: "https://images.pexels.com/photos/5410400/pexels-photo-5410400.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "12", name: "Special Fish Fry", price: 1800, category: "main", description: "Fresh fish marinated and fried with spices", image: "https://images.pexels.com/photos/262959/pexels-photo-262959.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "13", name: "Mango Shake", price: 400, category: "drinks", description: "Thick and creamy mango shake", image: "https://images.pexels.com/photos/775032/pexels-photo-775032.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "14", name: "Beef Burger Deluxe", price: 850, category: "fast-food", description: "Juicy beef patty with fresh toppings", image: "https://images.pexels.com/photos/1639557/pexels-photo-1639557.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "15", name: "Malai Boti", price: 1500, category: "bbq", description: "Creamy marinated chicken tikka", image: "https://images.pexels.com/photos/6210876/pexels-photo-6210876.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "16", name: "Gulab Jamun", price: 500, category: "dessert", description: "Traditional sweet dumplings in sugar syrup", image: "https://images.pexels.com/photos/4087611/pexels-photo-4087611.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "17", name: "Fresh Lime Soda", price: 300, category: "drinks", description: "Refreshing lime drink with soda", image: "https://images.pexels.com/photos/1233319/pexels-photo-1233319.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "18", name: "zaytoon Royal Mutton Karahi", price: 3800, category: "main", description: "Premium mutton cooked in traditional desi ghee with secret zaytoon spices.", image: "https://images.pexels.com/photos/2474661/pexels-photo-2474661.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "19", name: "Executive T-Bone Steak", price: 4500, category: "main", description: "Prime cut beef steak served with grilled vegetables and mushroom sauce.", image: "https://images.pexels.com/photos/675951/pexels-photo-675951.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "20", name: "Jumbo Grilled Prawns", price: 5200, category: "bbq", description: "Fresh jumbo prawns marinated in lemon butter and charcoal grilled.", image: "https://images.pexels.com/photos/566344/pexels-photo-566344.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "21", name: "Whole Stuffed Sajji", price: 2800, category: "main", description: "Full chicken stuffed with aromatic rice and slow-roasted over charcoal.", image: "https://images.pexels.com/photos/233305/pexels-photo-233305.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "22", name: "Grand zaytoon BBQ Platter", price: 4800, category: "bbq", description: "A royal mix of Kababs, Tikka, Malai Boti, and Chops for the whole family.", image: "https://images.pexels.com/photos/958545/pexels-photo-958545.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "23", name: "Beef Wellington Exclusive", price: 6500, category: "main", description: "Tender beef fillet wrapped in puff pastry with mushroom duxelles.", image: "https://images.pexels.com/photos/7613568/pexels-photo-7613568.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "24", name: "Mutton Kunna Clay Pot", price: 3400, category: "main", description: "Traditional Chinioti Mutton Kunna slow-cooked in a clay pot for 6 hours.", image: "https://images.pexels.com/photos/106343/pexels-photo-106343.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "25", name: "Grilled Lobster Tail", price: 6800, category: "main", description: "Premium lobster tail served with garlic butter sauce and saffron rice.", image: "https://images.pexels.com/photos/699953/pexels-photo-699953.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "26", name: "Turkish Adana Kebab Platter", price: 3500, category: "bbq", description: "Authentic spicy Turkish minced meat kebabs served with pita and hummus.", image: "https://images.pexels.com/photos/5946633/pexels-photo-5946633.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "27", name: "Desi Ghee Lamb Chops", price: 4200, category: "bbq", description: "Juicy lamb chops marinated in yogurt and pan-fried in pure desi ghee.", image: "https://images.pexels.com/photos/410648/pexels-photo-410648.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "28", name: "College Hangout Deal", price: 2800, category: "main", description: "4 zaytoon Burgers, 2 Jumbo Fries, and 1.5L Coke. Best for college friends and groups.", image: "https://images.pexels.com/photos/70497/pexels-photo-70497.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "29", name: "Romantic Dinner Date", price: 5500, category: "main", description: "2 Premium Steaks, 1 Chocolate Lava Cake, and 2 Mint Margaritas. Includes table decoration.", image: "https://images.pexels.com/photos/262047/pexels-photo-262047.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "30", name: "Royal Family Feast", price: 12500, category: "main", description: "Full Mutton Karahi, 2 Large Pizzas, BBQ Platter, 2L Drinks, and 12 Gulab Jamuns. Serves 6-8.", image: "https://images.pexels.com/photos/958545/pexels-photo-958545.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "31", name: "Executive Business Buffet", price: 4500, category: "main", description: "Unlimited BBQ, 3 types of Handi, Chinese, Salad Bar, and Tea. Perfect for corporate meetings.", image: "https://images.pexels.com/photos/1267320/pexels-photo-1267320.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "32", name: "zaytoon Birthday Blast Pack", price: 15000, category: "main", description: "Party for 10! Mixed BBQ, Fast Food Platter, Customized Cake, and unlimited soft drinks.", image: "https://images.pexels.com/photos/587741/pexels-photo-587741.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "33", name: "Couple's BBQ Night", price: 3200, category: "bbq", description: "Seekh Kabab, Malai Boti, Chicken Tikka, Raita, and Hot Naans. Specially for two.", image: "https://images.pexels.com/photos/5410400/pexels-photo-5410400.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "34", name: "Weekend Brunch Group", price: 4800, category: "main", description: "Special Halwa Puri, Nihari, Paye, and Lassi for a group of 4. Only on Saturday/Sunday.", image: "https://images.pexels.com/photos/103124/pexels-photo-103124.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "35", name: "zaytoon Signature Elite Deal", price: 25000, category: "main", description: "The most expensive deal. Stuffed Lamb, Seafood Mix, Royal Desserts, and Private Cabin for 12.", image: "https://images.pexels.com/photos/6267/menu-restaurant-vintage-table.jpg?auto=compress&cs=tinysrgb&w=600" },
            { id: "36", name: "Classic Margherita", price: 1200, category: "pizza", description: "Traditional Italian style with fresh tomato sauce, basil, and pure mozzarella.", image: "https://images.pexels.com/photos/1146760/pexels-photo-1146760.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "37", name: "zaytoon Signature Tikka", price: 1650, category: "pizza", description: "Desi style spicy chicken tikka chunks with onions and green peppers.", image: "https://images.pexels.com/photos/825661/pexels-photo-825661.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "38", name: "Spicy Chicken Fajita", price: 1750, category: "pizza", description: "Marinated fajita chicken, jalapeos, olives, and extra stringy cheese.", image: "https://images.pexels.com/photos/10790638/pexels-photo-10790638.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "39", name: "Premium Pepperoni Feast", price: 1850, category: "pizza", description: "Loaded with premium beef pepperoni slices and double mozzarella.", image: "https://images.pexels.com/photos/1552635/pexels-photo-1552635.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "40", name: "zaytoon Stuffed Crust Gold", price: 2200, category: "pizza", description: "Cheese-filled crust with any topping of your choice. A 7-star favorite.", image: "https://images.pexels.com/photos/2619967/pexels-photo-2619967.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "41", name: "Veggie Delight Supreme", price: 1400, category: "pizza", description: "Corn, mushrooms, olives, peppers, and onions. Healthy and delicious.", image: "https://images.pexels.com/photos/3652899/pexels-photo-3652899.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "42", name: "Smokey BBQ Chicken Pizza", price: 1800, category: "pizza", description: "BBQ sauce base with grilled chicken, red onions, and sweet corn.", image: "https://images.pexels.com/photos/4394612/pexels-photo-4394612.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "43", name: "Royal Seafood Pizza", price: 2800, category: "pizza", description: "Premium topping of prawns and tuna with a hint of garlic and herbs.", image: "https://images.pexels.com/photos/2147491/pexels-photo-2147491.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "44", name: "Club Sandwich Max (Pizza)", price: 750, category: "pizza", description:"zaytoon king", image: "https://images.pexels.com/photos/1600727/pexels-photo-1600727.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "45", name: "Assorted Turkish Baklava Box", price: 2500, category: "sweets", description: "Premium 500g box of authentic Turkish Baklava with pistachios and honey.", image: "https://images.pexels.com/photos/10313462/pexels-photo-10313462.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "46", name: "Belgian Chocolate Fudge Cake", price: 3800, category: "sweets", description: "Full 2lbs rich chocolate cake made with premium Belgian cocoa and dark chocolate.", image: "https://images.pexels.com/photos/291528/pexels-photo-291528.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "47", name: "New York Cheesecake (Slice)", price: 850, category: "sweets", description: "Creamy, smooth cheesecake on a graham cracker crust with strawberry topping.", image: "https://images.pexels.com/photos/1126359/pexels-photo-1126359.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "48", name: "zaytoon Royal Shahi Tukray", price: 1200, category: "sweets", description: "Traditional bread pudding slow-cooked in thick saffron milk and dry fruits.", image: "https://images.pexels.com/photos/1359302/pexels-photo-1359302.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "49", name: "Premium Macarons Gift Box", price: 1800, category: "sweets", description: "Box of 12 colorful French macarons with assorted flavors like lavender, rose, and pistachio.", image: "https://images.pexels.com/photos/239578/pexels-photo-239578.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "50", name: "Custom Fondant Celebration Cake", price: 4800, category: "sweets", description: "2kg custom designed cake for birthdays or anniversaries with edible fondant art.", image: "https://images.pexels.com/photos/1702373/pexels-photo-1702373.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "51", name: "Desi Ghee Gajar Ka Halwa", price: 950, category: "sweets", description: "Fresh carrots slow-cooked in pure desi ghee and khoya. A winter special.", image: "https://images.pexels.com/photos/5639413/pexels-photo-5639413.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "52", name: "Premium Assorted Cookies Bucket", price: 1500, category: "sweets", description: "1kg freshly baked bakery cookies including Almond, Chocolate Chip, and Pistachio.", image: "https://images.pexels.com/photos/230325/pexels-photo-230325.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "53", name: "zaytoon Gold Leaf Matka Kheer", price: 2200, category: "sweets", description: "Elite kheer served in traditional clay pots decorated with real edible gold leaf.", image: "https://images.pexels.com/photos/4087611/pexels-photo-4087611.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "54", name: "Premium Fettuccine Alfredo", price: 1850, category: "main", description: "Creamy white sauce pasta with grilled chicken chunks, mushrooms, and imported parmesan cheese.", image: "https://images.pexels.com/photos/1437267/pexels-photo-1437267.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "55", name: "Royal Mutton Raan Roast", price: 7500, category: "main", description: "Whole leg of lamb slow-roasted for 8 hours, marinated in secret zaytoon royal spices. Serves 4-5.", image: "https://images.pexels.com/photos/541216/pexels-photo-541216.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "56", name: "Spicy Seafood Penne", price: 2400, category: "main", description: "Penne pasta tossed in spicy red arrabbiata sauce with sauted prawns and calamari.", image: "https://images.pexels.com/photos/14737/pexels-photo.jpg?auto=compress&cs=tinysrgb&w=600" },
            { id: "57", name: "Saffron Pistachio Kheer", price: 1100, category: "sweets", description: "Traditional slow-cooked rice pudding infused with pure saffron and topped with roasted pistachios.", image: "https://images.pexels.com/photos/1359302/pexels-photo-1359302.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "58", name: "Premium Beef Nalli Nihari", price: 3200, category: "main", description: "Buffalo meat slow-cooked to perfection with bone marrow (Nalli) and authentic Nihari spices. Served with ginger and lemon.", image: "https://images.pexels.com/photos/604969/pexels-photo-604969.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "59", name: "zaytoon Special Beef Karahi", price: 2800, category: "main", description: "Fresh buffalo meat stir-fried in a wok with tomatoes, green chilies, and black pepper. Authentic 7-star taste.", image: "https://images.pexels.com/photos/1624487/pexels-photo-1624487.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "60", name: "Baked Chicken Lasagna", price: 2100, category: "main", description: "Layers of pasta sheet filled with minced chicken, red sauce, and topped with a heavy layer of melted mozzarella and cheddar.", image: "https://images.pexels.com/photos/5949900/pexels-photo-5949900.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "61", name: "Exotic Fruit Trifle Custard", price: 1250, category: "sweets", description: "Multi-layered dessert with vanilla custard, fresh seasonal fruits, jelly, and soft sponge cake. A family favorite.", image: "https://images.pexels.com/photos/2693447/pexels-photo-2693447.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "62", name: "Premium Fruit Cream Salad", price: 1450, category: "sweets", description: "A rich mix of fresh fruits, cocktail fruits, and dry fruits folded into chilled, whipped fresh cream.", image: "https://images.pexels.com/photos/11305342/pexels-photo-11305342.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "63", name: "Creamy Chicken Macaroni", price: 1650, category: "main", description: "Italian style macaroni tossed in a rich, creamy bechamel sauce with tender chicken chunks and bell peppers.", image: "https://images.pexels.com/photos/1438672/pexels-photo-1438672.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "64", name: "Bana Shake", price: 400, category: "drinks", description: "Thick and creamy banana shake", image: "https://images.pexels.com/photos/775032/pexels-photo-775032.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "65", name: "Double Beef Burger Deluxe", price: 1050, category: "fast-food", description: "Double juicy beef patty with fresh toppings", image: "https://images.pexels.com/photos/1639557/pexels-photo-1639557.jpeg?auto=compress&cs=tinysrgb&w=600" },
            { id: "66", name: "Crispy Chicken Strips", price: 700, category: "fast-food", description: "Golden fried chicken strips with dipping sauce", image: "https://images.pexels.com/photos/60616/fried-chicken-gold-salt-batter-60616.jpeg?auto=compress&cs=tinysrgb&w=600"}
        ];


        // Function to seed initial menu items into Firestore
        async function seedMenuItems() {
            const menuItemsCollection = collection(db, 'menuItems');
            
            // Check if any items exist in Firestore. We only seed if the collection is truly empty.
            const existingItemsSnapshot = await getDocs(menuItemsCollection);
            if (!existingItemsSnapshot.empty) {
                console.log("Firebase 'menuItems' collection already has items. Skipping initial seeding.");
                return;
            }

            console.log("Firebase 'menuItems' collection is empty. Seeding initial items...");
            let itemsAdded = 0;
            for (const item of initialMenuItemsToSeed) {
                try {
                    // Using setDoc with item.id.toString() to ensure Firebase document IDs match our local IDs
                    // This is important for consistency in cart operations later.
                    await setDoc(doc(db, 'menuItems', item.id.toString()), {
                        name: item.name,
                        description: item.description,
                        price: item.price,
                        category: item.category,
                        image: item.image,
                        timestamp: serverTimestamp() // Add a timestamp for consistency
                    });
                    itemsAdded++;
                } catch (error) {
                    console.error("Error seeding menu item:", item.name, error);
                }
            }

            if (itemsAdded > 0) {
                console.log(`Successfully added ${itemsAdded} initial menu items to Firestore.`);
            } else {
                console.log("No initial menu items were added (possibly due to errors during seeding).");
            }
        }


        // Function to load settings from Firestore
        async function loadSettings() {
            const settingsDocRef = doc(db, 'settings', 'websiteSettings');
            const docSnap = await getDoc(settingsDocRef);
            if (docSnap.exists()) {
                const settings = docSnap.data();
                frontendContactNumbers = settings.contactNumbers || {};
                frontendPaymentDetails = settings.paymentDetails || {};
                autoReplyMessage = settings.autoReplyMessage || "Thank you for your message! We will get back to you shortly.";

                // Update frontend elements with loaded settings
                document.getElementById('booking-call-number').textContent = frontendContactNumbers.call || '+92 318 8791637';
                document.getElementById('contact-phone').textContent = frontendContactNumbers.call || '+92 318 8791637';
                document.getElementById('footer-phone-number').textContent = frontendContactNumbers.call || '+92 318 8791637';
                
                document.getElementById('checkout-jazzcash-num').textContent = frontendPaymentDetails.jazzcash || '0304-9472735';
                document.getElementById('checkout-easypaisa-num').textContent = frontendPaymentDetails.easypaisa || '0318-8791637';
                document.getElementById('checkout-bank-acc-no').textContent = frontendPaymentDetails.bankAccNo || '1234567890';
                document.getElementById('checkout-bank-acc-holder').textContent = frontendPaymentDetails.bankAccHolder || 'Zaytoon Garden';
                document.getElementById('checkout-bank-name').textContent = frontendPaymentDetails.bankName || 'HBL';
            } else {
                // If settings don't exist, create default ones
                await setDoc(settingsDocRef, {
                    contactNumbers: {
                        whatsapp: '+923188791637',
                        call: '+923184195665',
                        sms: '+923188791637'
                    },
                    paymentDetails: {
                        jazzcash: '0304-9472735',
                        easypaisa: '0318-8791637',
                        bankAccNo: '1234567890',
                        bankAccHolder: 'Zaytoon Garden',
                        bankName: 'HBL'
                    },
                    autoReplyMessage: "Thank you for your message! We will get back to you shortly."
                });
                console.log("Default settings created.");
                loadSettings(); // Reload settings after creating defaults
            }
        }


        // Initialize
        window.addEventListener('load', async () => {
            await loadSettings(); // Load settings first
            await seedMenuItems(); // Call the seeding function here to add default items if not present
            
            setTimeout(() => {
                document.getElementById('loading-screen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loading-screen').style.display = 'none';
                }, 500); // Allow fade out animation
            }, 1000);

            AOS.init({ duration: 1000, once: true });
            
            // Listen for real-time menu item updates from Firebase
            onSnapshot(collection(db, 'menuItems'), (snapshot) => {
                menuItemsData = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                renderMenu('all'); // Re-render menu whenever data changes
                if (adminLoggedIn) {
                    renderAdminMenuItems(); // Re-render admin menu list too
                }
            }, (error) => {
                console.error("Error fetching menu items:", error);
                showNotification("Failed to load menu items.", "error");
            });

            setupEventListeners();
            loadCartFromStorage();
            updateCartSummary(); // Ensure summary is updated on load with default delivery
            
            // Check admin login status on page load
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    adminLoggedIn = true;
                    console.log("Admin is logged in.");
                    // Optionally show admin panel directly if already logged in, or update UI elements
                } else {
                    adminLoggedIn = false;
                    console.log("Admin is logged out.");
                }
            });

            // Set up listener for user chat modal to load history
            const userChatModalElement = document.getElementById('userChatModal');
            userChatModalElement.addEventListener('show.bs.modal', setupUserChat);
            userChatModalElement.addEventListener('hidden.bs.modal', () => {
                // Clear chat when modal is closed
                document.getElementById('user-chat-messages').innerHTML = '';
                localStorage.removeItem('userChatId'); // Clear stored chat ID
                localStorage.removeItem('userChatName'); // Clear stored chat name
            });
        });

        // Sticky Navbar
        window.addEventListener('scroll', () => {
            const navbar = document.querySelector('.navbar');
            if (window.scrollY > 50) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });

        function renderMenu(category) {
            const container = document.getElementById('menu-container');
            container.innerHTML = '';
            const filtered = category === 'all' ? menuItemsData : menuItemsData.filter(i => i.category === category);

            if (filtered.length === 0) {
                container.innerHTML = `<div class="col-12 text-center py-5"><p class="lead text-muted">No items found in this category.</p></div>`;
                return;
            }

            filtered.forEach(item => {
                const qty = getItemQuantity(item.id);
                container.innerHTML += `
                    <div class="col-lg-3 col-md-6" data-aos="fade-up">
                        <div class="menu-item">
                            <div class="menu-item-image">
                                <span class="menu-badge">${item.category.replace(/-/g, ' ')}</span>
                                <img src="${item.image || 'https://via.placeholder.com/250x250?text=No+Image'}" alt="${item.name}">
                            </div>
                            <div class="menu-item-content">
                                <h5>${item.name}</h5>
                                <p>${item.description}</p>
                                <div class="d-flex justify-content-between align-items-center mt-3">
                                    <span class="menu-price">Rs. ${item.price}</span>
                                    ${qty > 0 ? `
                                        <div class="quantity-controls">
                                            <button class="quantity-btn" onclick="decreaseQuantity('${item.id}')">-</button>
                                            <span class="px-3">${qty}</span>
                                            <button class="quantity-btn" onclick="increaseQuantity('${item.id}')">+</button>
                                        </div>
                                    ` : `
                                        <button class="add-to-cart-btn" onclick="addToCart('${item.id}')">
                                            <i class="fas fa-plus me-1"></i>Add
                                        </button>
                                    `}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        function setupEventListeners() {
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    renderMenu(btn.dataset.category);
                });
            });

            document.getElementById('payment-method').addEventListener('change', (e) => {
                const details = document.getElementById('payment-details');
                details.style.display = e.target.value !== 'cod' ? 'block' : 'none';
            });

            document.querySelectorAll('.delivery-option').forEach(option => {
                option.addEventListener('click', () => {
                    setDeliveryOption(option.dataset.option);
                });
            });

            document.getElementById('checkout-form').addEventListener('submit', placeOrder);
            document.getElementById('admin-login-form').addEventListener('submit', adminLogin);
            document.getElementById('menu-item-form').addEventListener('submit', handleMenuItemFormSubmit);
            document.getElementById('booking-form').addEventListener('submit', handleBookingFormSubmit);
            
            // User chat event listeners
            document.getElementById('userChatSendBtn').addEventListener('click', sendUserMessage);
            document.getElementById('userChatMessageInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendUserMessage();
            });

            // Admin chat event listener (for modal)
            document.getElementById('adminChatSendBtn').addEventListener('click', sendAdminMessage);
            document.getElementById('adminChatInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendAdminMessage();
            });

            // Admin settings event listeners
            document.getElementById('contact-numbers-form').addEventListener('submit', saveContactNumbers);
            document.getElementById('payment-details-form').addEventListener('submit', savePaymentDetails);
            document.getElementById('auto-reply-form').addEventListener('submit', saveAutoReplyMessage);


            document.getElementById('subscribe-button').addEventListener('click', () => {
                const statusElement = document.getElementById('subscription-status');
                statusElement.textContent = 'Thank you for subscribing! We\'ll keep you updated.';
                // You could also add Firebase Cloud Messaging subscription logic here
            });
        }

        window.setDeliveryOption = (option) => {
            document.querySelectorAll('.delivery-option').forEach(opt => opt.classList.remove('active'));
            document.querySelector(`.delivery-option[data-option="${option}"]`).classList.add('active');
            deliveryOption = option;

            const addressGroup = document.getElementById('address-group');
            if (deliveryOption === 'pickup') {
                addressGroup.style.display = 'none';
                document.getElementById('customer-address').removeAttribute('required');
            } else {
                addressGroup.style.display = 'block';
                document.getElementById('customer-address').setAttribute('required', 'required');
            }
            updateCartSummary();
        }

        window.addToCart = (id) => {
            const item = menuItemsData.find(i => i.id === id);
            const existing = cart.find(i => i.id === id);
            if (existing) existing.quantity++;
            else cart.push({ ...item, quantity: 1 });
            updateCart();
            showNotification(`${item.name} added to cart!`, 'success');
            renderMenu(document.querySelector('.category-btn.active').dataset.category);
        };

        window.increaseQuantity = (id) => {
            const item = cart.find(i => i.id === id);
            if (item) {
                item.quantity++;
                updateCart();
                renderMenu(document.querySelector('.category-btn.active').dataset.category);
            }
        };

        window.decreaseQuantity = (id) => {
            const item = cart.find(i => i.id === id);
            if (item) {
                if (item.quantity > 1) item.quantity--;
                else cart = cart.filter(i => i.id !== id);
                updateCart();
                renderCart(); // Call renderCart directly to update cart modal content
                renderMenu(document.querySelector('.category-btn.active').dataset.category);
            }
        };

        function getItemQuantity(id) {
            const item = cart.find(i => i.id === id);
            return item ? item.quantity : 0;
        }

        function updateCart() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cart-badge').textContent = totalItems;
            localStorage.setItem('cart', JSON.stringify(cart));
            renderCart();
            updateCartSummary();
        }

        function renderCart() {
            const container = document.getElementById('cart-items-container');
            if (cart.length === 0) {
                container.innerHTML = '<div class="p-5 text-center"><p class="text-muted">Your cart is empty.</p><p>Add some delicious items from our menu!</p></div>';
                return;
            }

            container.innerHTML = cart.map(item => `
                <div class="d-flex align-items-center p-3 border-bottom cart-item-row">
                    <img src="${item.image || 'https://via.placeholder.com/80x80?text=No+Image'}" style="width: 80px; height: 80px; object-fit: cover; border-radius: 10px;" alt="${item.name}">
                    <div class="flex-grow-1 ms-3">
                        <h6>${item.name}</h6>
                        <p class="mb-0 text-success">Rs. ${item.price}  ${item.quantity}</p>
                    </div>
                    <div class="quantity-controls me-3">
                        <button class="quantity-btn" onclick="decreaseQuantity('${item.id}')">-</button>
                        <span class="px-3">${item.quantity}</span>
                        <button class="quantity-btn" onclick="increaseQuantity('${item.id}')">+</button>
                    </div>
                </div>
            `).join('');
        }

        function updateCartSummary() {
            const subtotal = cart.reduce((sum, i) => sum + (i.price * i.quantity), 0);
            const delivery = deliveryOption === 'delivery' ? 150 : 0;
            const total = subtotal + delivery;

            document.getElementById('cart-subtotal').textContent = 'Rs. ' + subtotal;
            document.getElementById('delivery-charges').textContent = 'Rs. ' + delivery;
            document.getElementById('cart-total').textContent = 'Rs. ' + total;
        }

        function loadCartFromStorage() {
            const saved = localStorage.getItem('cart');
            if (saved) {
                cart = JSON.parse(saved);
                updateCart();
            }
        }

        window.proceedToCheckout = () => {
            if (cart.length === 0) {
                showNotification('Your cart is empty. Please add items before proceeding to checkout.', 'error');
                return;
            }
            bootstrap.Modal.getInstance(document.getElementById('cartModal')).hide();
            // Reset delivery option to default or previously selected on checkout modal open
            setTimeout(() => {
                new bootstrap.Modal(document.getElementById('checkoutModal')).show();
                // Re-apply active class to default delivery option if not set
                document.querySelectorAll('.delivery-option').forEach(opt => opt.classList.remove('active'));
                document.querySelector(`.delivery-option[data-option="${deliveryOption}"]`).classList.add('active');
                
                const addressGroup = document.getElementById('address-group');
                if (deliveryOption === 'pickup') {
                    addressGroup.style.display = 'none';
                    document.getElementById('customer-address').removeAttribute('required');
                } else {
                    addressGroup.style.display = 'block';
                    document.getElementById('customer-address').setAttribute('required', 'required');
                }
                updateCartSummary(); // Recalculate summary with current delivery option
            }, 300);
        };

        async function placeOrder(e) {
            e.preventDefault();
            
            const name = document.getElementById('customer-name').value;
            const phone = document.getElementById('customer-phone').value;
            const address = document.getElementById('customer-address').value;
            const paymentMethod = document.getElementById('payment-method').value;
            const orderNotes = document.getElementById('order-notes').value;
            
            let paymentScreenshotURL = null;
            
            if (paymentMethod !== 'cod') {
                const screenshotFile = document.getElementById('payment-screenshot').files[0];
                if (!screenshotFile) {
                    showNotification('Please upload payment screenshot for your chosen payment method!', 'error');
                    return;
                }
                
                // Upload screenshot to Firebase Storage
                const storageRef = ref(storage, `payment-screenshots/${Date.now()}_${screenshotFile.name}`);
                await uploadBytes(storageRef, screenshotFile);
                paymentScreenshotURL = await getDownloadURL(storageRef);
            }

            const subtotal = cart.reduce((sum, i) => sum + (i.price * i.quantity), 0);
            const deliveryCharge = deliveryOption === 'delivery' ? 150 : 0;
            const total = subtotal + deliveryCharge;
            const orderNumber = 'ZG' + Date.now().toString().slice(-8);

            const order = {
                orderNumber,
                customerName: name,
                customerPhone: phone,
                customerEmail: document.getElementById('customer-email').value,
                deliveryAddress: deliveryOption === 'delivery' ? address : 'Self Pickup',
                deliveryOption: deliveryOption,
                orderNotes: orderNotes,
                items: cart,
                subtotal,
                deliveryCharge: deliveryCharge,
                total,
                paymentMethod,
                paymentScreenshot: paymentScreenshotURL,
                status: 'Pending',
                timestamp: serverTimestamp(),
                date: new Date().toLocaleDateString('en-GB'),
                time: new Date().toLocaleTimeString('en-GB')
            };

            try {
                await addDoc(collection(db, 'orders'), order);
                
                // Construct WhatsApp message (using dynamic number from settings)
                const whatsappNumber = frontendContactNumbers.whatsapp || '923188791637'; // Default if not set
                let whatsappMessage = ` *NEW ORDER #${orderNumber}* \n\n`;
                whatsappMessage += `* Customer:* ${name}\n`;
                whatsappMessage += `* Phone:* ${phone}\n`;
                whatsappMessage += `* Email:* ${document.getElementById('customer-email').value || 'N/A'}\n`;
                whatsappMessage += `* Delivery Option:* ${deliveryOption === 'delivery' ? 'Home Delivery' : 'Self Pickup'}\n`;
                if (deliveryOption === 'delivery') {
                    whatsappMessage += `* Address:* ${address}\n`;
                }
                if (orderNotes) {
                    whatsappMessage += `* Notes:* ${orderNotes}\n`;
                }
                whatsappMessage += `\n* Items:*\n`;
                cart.forEach(item => {
                    whatsappMessage += ` ${item.name} x${item.quantity} = Rs. ${item.price * item.quantity}\n`;
                });
                whatsappMessage += `\n* Subtotal:* Rs. ${subtotal}\n`;
                whatsappMessage += `* Delivery Charges:* Rs. ${deliveryCharge}\n`;
                whatsappMessage += `* Total:* Rs. ${total}\n`;
                whatsappMessage += `* Payment Method:* ${paymentMethod.toUpperCase()}\n`;
                if (paymentScreenshotURL) {
                    whatsappMessage += `* Payment Screenshot:* ${paymentScreenshotURL}\n`;
                }
                whatsappMessage += `\n_Please confirm the order and prepare for ${deliveryOption === 'delivery' ? 'delivery' : 'pickup'}._`;

                window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(whatsappMessage)}`, '_blank');

                cart = [];
                localStorage.removeItem('cart');
                updateCart();
                
                bootstrap.Modal.getInstance(document.getElementById('checkoutModal')).hide();
                showNotification(`Order placed successfully! Order #${orderNumber}`, 'success');
                
                document.getElementById('checkout-form').reset();
            } catch (error) {
                console.error("Error placing order:", error);
                showNotification('Error placing order: ' + error.message, 'error');
            }
        }

        async function handleBookingFormSubmit(e) {
            e.preventDefault();

            const booking = {
                name: document.getElementById('booking-name').value,
                phone: document.getElementById('booking-phone').value,
                email: document.getElementById('booking-email').value,
                date: document.getElementById('booking-date').value,
                time: document.getElementById('booking-time').value,
                guests: document.getElementById('booking-guests').value,
                message: document.getElementById('booking-message').value,
                status: 'Pending',
                timestamp: serverTimestamp()
            };

            try {
                await addDoc(collection(db, 'bookings'), booking);
                showNotification('Booking submitted successfully! We will confirm shortly.', 'success');
                document.getElementById('booking-form').reset();

                // Send WhatsApp notification to admin for booking
                const whatsappNumber = frontendContactNumbers.whatsapp || '923188791637';
                let whatsappMessage = ` *NEW TABLE BOOKING* \n\n`;
                whatsappMessage += `* Name:* ${booking.name}\n`;
                whatsappMessage += `* Phone:* ${booking.phone}\n`;
                whatsappMessage += `* Email:* ${booking.email}\n`;
                whatsappMessage += `* Date:* ${booking.date}\n`;
                whatsappMessage += `* Time:* ${booking.time}\n`;
                whatsappMessage += `* Guests:* ${booking.guests}\n`;
                if (booking.message) {
                    whatsappMessage += `* Requests:* ${booking.message}\n`;
                }
                whatsappMessage += `\n_Please review and confirm the booking._`;
                window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(whatsappMessage)}`, '_blank');

            } catch (error) {
                console.error("Error submitting booking:", error);
                showNotification('Error submitting booking: ' + error.message, 'error');
            }
        }

        window.showAdminLogin = () => {
            new bootstrap.Modal(document.getElementById('adminLoginModal')).show();
        };

        async function adminLogin(e) {
            e.preventDefault();
            const email = document.getElementById('admin-email').value.trim();
            const password = document.getElementById('admin-password').value;
            try {
                await signInWithEmailAndPassword(auth, email, password);
                adminLoggedIn = true;
                bootstrap.Modal.getInstance(document.getElementById('adminLoginModal')).hide();
                showAdmin();
                showNotification('Admin login successful!', 'success');
            } catch (error) {
                if (error.code === 'auth/invalid-credential' || error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
                    showNotification('Invalid email or password!', 'error');
                } else {
                    showNotification('Error: ' + error.message, 'error');
                }
                console.error("Admin Login Error:", error);
            }
        }

        window.adminLogout = async () => {
            try {
                await signOut(auth);
                adminLoggedIn = false;
                closeAdmin();
                showNotification('Admin logged out successfully.', 'success');
            } catch (error) {
                console.error("Error logging out:", error);
                showNotification('Error logging out: ' + error.message, 'error');
            }
        };

        function showAdmin() {
            document.getElementById('admin-panel').style.display = 'flex'; // Use flex for sidebar layout
            loadAdminData();
            showAdminSection('dashboard-overview'); // Show dashboard by default
        }

        window.closeAdmin = () => {
            document.getElementById('admin-panel').style.display = 'none';
        };

        window.showAdminSection = (sectionId) => {
            document.querySelectorAll('.admin-section').forEach(section => {
                section.style.display = 'none';
            });
            document.querySelectorAll('.admin-sidebar .nav-link').forEach(link => {
                link.classList.remove('active');
            });

            document.getElementById(sectionId).style.display = 'block';
            document.querySelector(`.admin-sidebar .nav-link[href="#${sectionId}"]`).classList.add('active');

            // Trigger specific loaders for each section
            if (sectionId === 'admin-orders-list' || sectionId === 'dashboard-overview') {
                loadAdminOrders();
            } else if (sectionId === 'admin-menu-management') {
                renderAdminMenuItems(); // This is updated by the onSnapshot listener already
            } else if (sectionId === 'admin-bookings-list') {
                loadAdminBookings();
            } else if (sectionId === 'admin-messages-list') {
                loadAdminMessages();
            } else if (sectionId === 'admin-settings') {
                loadAdminSettingsForm();
            }
        };

        function loadAdminData() {
            // Live updates for orders
            const ordersQuery = query(collection(db, 'orders'), orderBy('timestamp', 'desc'));
            onSnapshot(ordersQuery, (snapshot) => {
                let total = 0;
                let pending = 0;
                let completed = 0;
                let revenue = 0;

                const orders = [];
                snapshot.forEach(doc => {
                    const order = { id: doc.id, ...doc.data() };
                    orders.push(order);
                    total++;
                    
                    if (order.status === 'Completed') {
                        completed++;
                        revenue += order.total;
                    } else {
                        pending++;
                    }
                });

                document.getElementById('total-orders').textContent = total;
                document.getElementById('pending-orders').textContent = pending;
                document.getElementById('completed-orders').textContent = completed;
                document.getElementById('total-revenue').textContent = 'Rs. ' + revenue;
                
                // Render recent orders for dashboard overview
                const recentOrdersContainer = document.getElementById('admin-orders-recent');
                recentOrdersContainer.innerHTML = orders.slice(0, 5).map(order => renderOrderCard(order)).join(''); // Show latest 5 orders
                // Render full orders list
                loadAdminOrders(orders); // Pass fetched orders to avoid refetching
            });

            // Live updates for bookings
            const bookingsQuery = query(collection(db, 'bookings'), orderBy('timestamp', 'desc'));
            onSnapshot(bookingsQuery, (snapshot) => {
                const bookings = [];
                snapshot.forEach(doc => bookings.push({ id: doc.id, ...doc.data() }));
                document.getElementById('total-bookings').textContent = bookings.length;
                loadAdminBookings(bookings); // Pass fetched bookings
            });

            // Live updates for chats (admin sees each chat document as a "message" entry)
            const chatsQuery = query(collection(db, 'chats'), orderBy('lastMessageTimestamp', 'desc'));
            onSnapshot(chatsQuery, (snapshot) => {
                const messages = [];
                let unreadCount = 0;
                snapshot.forEach(doc => {
                    const chat = { id: doc.id, ...doc.data() };
                    // Check for unread messages within each chat
                    if (chat.adminUnreadCount > 0) {
                        unreadCount += chat.adminUnreadCount;
                    }
                    messages.push(chat);
                });
                document.getElementById('new-messages').textContent = unreadCount;
                document.getElementById('unread-messages-badge').textContent = unreadCount;
                loadAdminMessages(messages); // Pass fetched chats
            });
        }

        function renderOrderCard(order) {
            return `
                <div class="order-card mb-3 ${order.status === 'Pending' ? 'unread' : ''}">
                    <div class="d-flex justify-content-between mb-3">
                        <h5>Order #${order.orderNumber}</h5>
                        <span class="badge bg-${order.status === 'Completed' ? 'success' : (order.status === 'Cancelled' ? 'danger' : 'warning')}">${order.status}</span>
                    </div>
                    <p><strong>Customer:</strong> ${order.customerName}</p>
                    <p><strong>Phone:</strong> ${order.customerPhone}</p>
                    ${order.customerEmail ? `<p><strong>Email:</strong> ${order.customerEmail}</p>` : ''}
                    <p><strong>Delivery Option:</strong> ${order.deliveryOption === 'delivery' ? 'Home Delivery' : 'Self Pickup'}</p>
                    <p><strong>Address:</strong> ${order.deliveryAddress}</p>
                    ${order.orderNotes ? `<p><strong>Notes:</strong> ${order.orderNotes}</p>` : ''}
                    <p><strong>Date:</strong> ${order.date} at ${order.time}</p>
                    <p><strong>Items:</strong></p>
                    <ul>
                        ${order.items.map(i => `<li>${i.name} x${i.quantity} (Rs. ${i.price * i.quantity})</li>`).join('')}
                    </ul>
                    <p><strong>Subtotal:</strong> Rs. ${order.subtotal}</p>
                    <p><strong>Delivery:</strong> Rs. ${order.deliveryCharge}</p>
                    <p><strong>Total:</strong> Rs. ${order.total}</p>
                    <p><strong>Payment:</strong> ${order.paymentMethod.toUpperCase()}</p>
                    ${order.paymentScreenshot ? `<p class="mb-2"><strong>Payment Screenshot:</strong></p><img src="${order.paymentScreenshot}" class="payment-screenshot" alt="Payment Screenshot">` : ''}
                    <div class="mt-3">
                        ${order.status === 'Pending' ? `
                            <button class="btn btn-success btn-sm me-2" onclick="updateOrderStatus('${order.id}', 'Completed')">
                                <i class="fas fa-check me-2"></i>Mark Complete
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="updateOrderStatus('${order.id}', 'Cancelled')">
                                <i class="fas fa-times me-2"></i>Cancel Order
                            </button>
                        ` : (order.status === 'Completed' ? `
                            <button class="btn btn-warning btn-sm" onclick="updateOrderStatus('${order.id}', 'Pending')">
                                <i class="fas fa-undo me-2"></i>Revert to Pending
                            </button>
                        ` : '')}
                    </div>
                </div>
            `;
        }
        
        function loadAdminOrders(orders = []) {
            const container = document.getElementById('admin-orders-full');
            if (orders.length === 0) {
                container.innerHTML = `<div class="p-5 text-center text-muted">No orders found.</div>`;
                return;
            }
            container.innerHTML = orders.map(order => renderOrderCard(order)).join('');
        }

        window.updateOrderStatus = async (id, newStatus) => {
            try {
                await updateDoc(doc(db, 'orders', id), { status: newStatus });
                showNotification(`Order status updated to ${newStatus}!`, 'success');
            } catch (error) {
                showNotification('Error updating order status: ' + error.message, 'error');
                console.error("Error updating order status:", error);
            }
        };

        // Menu Item Management (Admin)
        function renderAdminMenuItems() {
            const tableBody = document.getElementById('admin-menu-items-table');
            tableBody.innerHTML = '';

            if (menuItemsData.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="5" class="text-center text-muted py-4">No menu items found.</td></tr>`;
                return;
            }

            menuItemsData.forEach(item => {
                tableBody.innerHTML += `
                    <tr>
                        <td><img src="${item.image || 'https://via.placeholder.com/80x80?text=No+Image'}" alt="${item.name}" width="50" height="50" style="object-fit: cover; border-radius: 5px;"></td>
                        <td>${item.name}</td>
                        <td>${item.category.replace(/-/g, ' ')}</td>
                        <td>Rs. ${item.price}</td>
                        <td>
                            <button class="btn btn-sm btn-info me-2" data-bs-toggle="modal" data-bs-target="#addEditMenuItemModal" onclick="prepareMenuItemForm('${item.id}')">Edit</button>
                            <button class="btn btn-sm btn-danger" onclick="deleteMenuItem('${item.id}', '${item.image}')">Delete</button>
                        </td>
                    </tr>
                `;
            });
        }

        window.prepareMenuItemForm = (itemId = null) => {
            const modalLabel = document.getElementById('addEditMenuItemModalLabel');
            const form = document.getElementById('menu-item-form');
            form.reset();
            document.getElementById('menu-item-id').value = '';
            document.getElementById('current-image-preview').innerHTML = ''; // Clear preview

            if (itemId) {
                modalLabel.textContent = 'Edit Menu Item';
                const item = menuItemsData.find(i => i.id === itemId);
                if (item) {
                    document.getElementById('menu-item-id').value = item.id;
                    document.getElementById('menu-item-name').value = item.name;
                    document.getElementById('menu-item-description').value = item.description;
                    document.getElementById('menu-item-price').value = item.price;
                    document.getElementById('menu-item-category').value = item.category;
                    document.getElementById('menu-item-image-url').value = item.image;
                    if (item.image) {
                        document.getElementById('current-image-preview').innerHTML = `Current Image: <img src="${item.image}" alt="current" style="width: 50px; height: 50px; object-fit: cover; border-radius: 5px;">`;
                    }
                }
            } else {
                modalLabel.textContent = 'Add New Menu Item';
            }
        };

        async function handleMenuItemFormSubmit(e) {
            e.preventDefault();
            const itemId = document.getElementById('menu-item-id').value;
            const name = document.getElementById('menu-item-name').value;
            const description = document.getElementById('menu-item-description').value;
            const price = parseFloat(document.getElementById('menu-item-price').value);
            const category = document.getElementById('menu-item-category').value;
            let imageUrl = document.getElementById('menu-item-image-url').value;
            const imageFile = document.getElementById('menu-item-image-upload').files[0];

            if (imageFile) {
                const storageRef = ref(storage, `menu-images/${Date.now()}_${imageFile.name}`);
                await uploadBytes(storageRef, imageFile);
                imageUrl = await getDownloadURL(storageRef);
            }

            const itemData = {
                name,
                description,
                price,
                category,
                image: imageUrl,
                timestamp: serverTimestamp()
            };

            try {
                if (itemId) {
                    await updateDoc(doc(db, 'menuItems', itemId), itemData);
                    showNotification('Menu item updated successfully!', 'success');
                } else {
                    await setDoc(doc(db, 'menuItems', Date.now().toString()), itemData); // Using timestamp as ID for new items
                    showNotification('New menu item added successfully!', 'success');
                }
                bootstrap.Modal.getInstance(document.getElementById('addEditMenuItemModal')).hide();
                document.getElementById('menu-item-form').reset();
            } catch (error) {
                console.error("Error saving menu item:", error);
                showNotification('Error saving menu item: ' + error.message, 'error');
            }
        }

        window.deleteMenuItem = async (itemId, imageUrl) => {
            if (confirm("Are you sure you want to delete this menu item?")) {
                try {
                    await deleteDoc(doc(db, 'menuItems', itemId));
                    // If the image was uploaded to Firebase Storage, delete it too
                    if (imageUrl && imageUrl.includes("firebasestorage.googleapis.com")) {
                        const imageRef = ref(storage, imageUrl);
                        await deleteObject(imageRef);
                    }
                    showNotification('Menu item deleted successfully!', 'success');
                } catch (error) {
                    console.error("Error deleting menu item:", error);
                    showNotification('Error deleting menu item: ' + error.message, 'error');
                }
            }
        };

        // Bookings Management (Admin)
        function loadAdminBookings(bookings = []) {
            const container = document.getElementById('admin-bookings-container');
            if (bookings.length === 0) {
                container.innerHTML = `<div class="p-5 text-center text-muted">No bookings found.</div>`;
                return;
            }
            container.innerHTML = bookings.map(booking => `
                <div class="booking-card mb-3 ${booking.status === 'Pending' ? 'unread' : ''}">
                    <div class="d-flex justify-content-between mb-3">
                        <h5>Booking for ${booking.name}</h5>
                        <span class="badge bg-${booking.status === 'Confirmed' ? 'success' : (booking.status === 'Cancelled' ? 'danger' : 'warning')}">${booking.status}</span>
                    </div>
                    <p><strong>Phone:</strong> ${booking.phone}</p>
                    <p><strong>Email:</strong> ${booking.email}</p>
                    <p><strong>Date & Time:</strong> ${booking.date} at ${booking.time}</p>
                    <p><strong>Guests:</strong> ${booking.guests}</p>
                    ${booking.message ? `<p><strong>Requests:</strong> ${booking.message}</p>` : ''}
                    <p><strong>Submitted:</strong> ${new Date(booking.timestamp?.toDate()).toLocaleString()}</p>
                    <div class="mt-3">
                        ${booking.status === 'Pending' ? `
                            <button class="btn btn-success btn-sm me-2" onclick="updateBookingStatus('${booking.id}', 'Confirmed')">
                                <i class="fas fa-check me-2"></i>Confirm
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="updateBookingStatus('${booking.id}', 'Cancelled')">
                                <i class="fas fa-times me-2"></i>Cancel
                            </button>
                        ` : (booking.status === 'Confirmed' ? `
                            <button class="btn btn-warning btn-sm" onclick="updateBookingStatus('${booking.id}', 'Pending')">
                                <i class="fas fa-undo me-2"></i>Revert to Pending
                            </button>
                        ` : '')}
                    </div>
                </div>
            `).join('');
        }

        window.updateBookingStatus = async (id, newStatus) => {
            try {
                await updateDoc(doc(db, 'bookings', id), { status: newStatus });
                showNotification(`Booking status updated to ${newStatus}!`, 'success');
            } catch (error) {
                showNotification('Error updating booking status: ' + error.message, 'error');
                console.error("Error updating booking status:", error);
            }
        };

        // User Chat / Admin Messages Management
        let adminChatModalInstance = null; // Store Bootstrap modal instance for admin chat

        function loadAdminMessages(chats = []) {
            const container = document.getElementById('admin-messages-container');
            if (chats.length === 0) {
                container.innerHTML = `<div class="p-5 text-center text-muted">No customer messages.</div>`;
                return;
            }
            container.innerHTML = chats.map(chat => `
                <div class="message-card mb-3 ${chat.adminUnreadCount > 0 ? 'unread' : ''}">
                    <div class="d-flex justify-content-between mb-3">
                        <h5>Chat with ${chat.userName || chat.id.substring(0, 8)}</h5>
                        ${chat.adminUnreadCount > 0 ? `<span class="badge bg-danger">${chat.adminUnreadCount} New</span>` : `<span class="badge bg-success">Read</span>`}
                    </div>
                    <p><strong>Last Message:</strong> ${chat.lastMessage}</p>
                    <p class="small text-muted"><em>${new Date(chat.lastMessageTimestamp?.toDate()).toLocaleString()}</em></p>
                    <div class="mt-3">
                        <button class="btn btn-primary btn-sm me-2" onclick="openAdminChat('${chat.id}', '${chat.userName || chat.id.substring(0, 8)}')">
                            <i class="fas fa-comments me-2"></i>View Chat
                        </button>
                        ${chat.adminUnreadCount > 0 ? `
                            <button class="btn btn-info btn-sm" onclick="markChatAsRead('${chat.id}')">
                                <i class="fas fa-check-double me-2"></i>Mark Read
                            </button>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        window.openAdminChat = async (chatId, userName) => {
            currentUserChatId = chatId;
            document.getElementById('chat-user-name').textContent = userName;
            
            // Show modal
            if (!adminChatModalInstance) {
                adminChatModalInstance = new bootstrap.Modal(document.getElementById('adminChatModal'));
            }
            adminChatModalInstance.show();

            const chatMessagesContainer = document.getElementById('adminChatModalBody');
            chatMessagesContainer.innerHTML = 'Loading messages...';

            // Mark all messages in this chat as read for admin
            await updateDoc(doc(db, 'chats', chatId), { adminUnreadCount: 0 });

            // Listen for real-time messages in this specific chat
            const q = query(collection(db, 'chats', chatId, 'messages'), orderBy('timestamp'));
            onSnapshot(q, (snapshot) => {
                chatMessagesContainer.innerHTML = '';
                snapshot.forEach(doc => {
                    const msg = doc.data();
                    const messageClass = msg.sender === 'admin' ? 'sent' : 'received';
                    const timestamp = msg.timestamp ? new Date(msg.timestamp.toDate()).toLocaleString() : 'Just now';
                    chatMessagesContainer.innerHTML += `
                        <div class="chat-message ${messageClass}">
                            <p class="mb-0">${msg.text}</p>
                            <small class="chat-timestamp">${timestamp}</small>
                        </div>
                    `;
                });
                chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight; // Scroll to bottom
            }, (error) => {
                console.error("Error fetching chat messages:", error);
                chatMessagesContainer.innerHTML = '<p class="text-danger">Error loading messages.</p>';
            });
        };

        window.markChatAsRead = async (chatId) => {
            try {
                await updateDoc(doc(db, 'chats', chatId), { adminUnreadCount: 0 });
                showNotification('Chat marked as read!', 'success');
            } catch (error) {
                showNotification('Error marking chat as read: ' + error.message, 'error');
                console.error("Error marking chat as read:", error);
            }
        };

        async function sendAdminMessage() {
            const input = document.getElementById('adminChatInput');
            const messageText = input.value.trim();
            if (messageText && currentUserChatId) {
                try {
                    await addDoc(collection(db, 'chats', currentUserChatId, 'messages'), {
                        sender: 'admin',
                        text: messageText,
                        timestamp: serverTimestamp(),
                        isReadByUser: false // Admin messages are unread by user initially
                    });
                    // Update last message in parent chat document
                    await updateDoc(doc(db, 'chats', currentUserChatId), {
                        lastMessage: messageText,
                        lastMessageTimestamp: serverTimestamp(),
                        userUnreadCount: arrayUnion(true) // Mark as unread for the user
                    });
                    input.value = '';
                } catch (error) {
                    showNotification('Error sending message: ' + error.message, 'error');
                    console.error("Error sending admin message:", error);
                }
            }
        }

        let userChatId = localStorage.getItem('userChatId'); // Store unique chat ID for user
        let userChatName = localStorage.getItem('userChatName'); // Store user's name for chat

        async function setupUserChat() {
            const userChatMessagesContainer = document.getElementById('user-chat-messages');
            userChatMessagesContainer.innerHTML = 'Loading chat...';

            if (!userChatId) {
                // Prompt user for name if not already stored
                userChatName = prompt("Please enter your name for the chat:");
                if (!userChatName) {
                    userChatName = "Guest " + Math.random().toString(36).substring(2, 10); // Anonymous if no name given
                }
                localStorage.setItem('userChatName', userChatName);

                // Create a new chat document in 'chats' collection
                const newChatRef = await addDoc(collection(db, 'chats'), {
                    userName: userChatName,
                    lastMessage: "New chat started.",
                    lastMessageTimestamp: serverTimestamp(),
                    adminUnreadCount: 1, // Admin has one unread message (the "chat started" one)
                    userUnreadCount: []
                });
                userChatId = newChatRef.id;
                localStorage.setItem('userChatId', userChatId);

                // Add initial message to subcollection
                await addDoc(collection(db, 'chats', userChatId, 'messages'), {
                    sender: 'user',
                    text: 'Hello, I have a question.', // Or an empty starter message
                    timestamp: serverTimestamp(),
                    isReadByAdmin: false
                });

                // Send auto-reply if set
                if (autoReplyMessage) {
                    await addDoc(collection(db, 'chats', userChatId, 'messages'), {
                        sender: 'admin',
                        text: autoReplyMessage,
                        timestamp: serverTimestamp(),
                        isReadByUser: false
                    });
                     await updateDoc(doc(db, 'chats', userChatId), {
                        lastMessage: autoReplyMessage, // Update last message to auto-reply
                        lastMessageTimestamp: serverTimestamp(),
                        userUnreadCount: arrayUnion(true) // Auto-reply is unread by user
                    });
                }
            } else {
                // If userChatId exists, mark all admin messages in this chat as read by the user
                const chatRef = doc(db, 'chats', userChatId);
                await updateDoc(chatRef, { userUnreadCount: [] });
            }

            // Listen for messages in the user's chat
            const q = query(collection(db, 'chats', userChatId, 'messages'), orderBy('timestamp'));
            onSnapshot(q, (snapshot) => {
                userChatMessagesContainer.innerHTML = '';
                snapshot.forEach(doc => {
                    const msg = doc.data();
                    const messageClass = msg.sender === 'user' ? 'sent' : 'received';
                    const timestamp = msg.timestamp ? new Date(msg.timestamp.toDate()).toLocaleString() : 'Just now';
                    userChatMessagesContainer.innerHTML += `
                        <div class="chat-message ${messageClass}">
                            <p class="mb-0">${msg.text}</p>
                            <small class="chat-timestamp">${timestamp}</small>
                        </div>
                    `;
                });
                userChatMessagesContainer.scrollTop = userChatMessagesContainer.scrollHeight; // Scroll to bottom
            }, (error) => {
                console.error("Error fetching user chat messages:", error);
                userChatMessagesContainer.innerHTML = '<p class="text-danger">Error loading chat.</p>';
            });
        }

        async function sendUserMessage() {
            const input = document.getElementById('userChatMessageInput');
            const messageText = input.value.trim();
            if (messageText && userChatId) {
                try {
                    await addDoc(collection(db, 'chats', userChatId, 'messages'), {
                        sender: 'user',
                        text: messageText,
                        timestamp: serverTimestamp(),
                        isReadByAdmin: false // User messages are unread by admin initially
                    });
                    // Update last message in parent chat document and increment admin unread count
                    const chatRef = doc(db, 'chats', userChatId);
                    await updateDoc(chatRef, {
                        lastMessage: messageText,
                        lastMessageTimestamp: serverTimestamp(),
                        adminUnreadCount: arrayUnion(true) // Increment adminUnreadCount
                    });
                    input.value = '';
                } catch (error) {
                    showNotification('Error sending message: ' + error.message, 'error');
                    console.error("Error sending user message:", error);
                }
            }
        }


        // Admin Settings Functions
        async function loadAdminSettingsForm() {
            const settingsDocRef = doc(db, 'settings', 'websiteSettings');
            const docSnap = await getDoc(settingsDocRef);
            if (docSnap.exists()) {
                const settings = docSnap.data();
                const contact = settings.contactNumbers || {};
                const payment = settings.paymentDetails || {};

                document.getElementById('setting-whatsapp-num').value = contact.whatsapp || '';
                document.getElementById('setting-call-num').value = contact.call || '';
                document.getElementById('setting-sms-num').value = contact.sms || '';

                document.getElementById('setting-jazzcash-num').value = payment.jazzcash || '';
                document.getElementById('setting-easypaisa-num').value = payment.easypaisa || '';
                document.getElementById('setting-bank-acc-no').value = payment.bankAccNo || '';
                document.getElementById('setting-bank-acc-holder').value = payment.bankAccHolder || '';
                document.getElementById('setting-bank-name').value = payment.bankName || '';

                document.getElementById('setting-auto-reply').value = settings.autoReplyMessage || '';
            }
        }

        async function saveContactNumbers(e) {
            e.preventDefault();
            const whatsapp = document.getElementById('setting-whatsapp-num').value;
            const call = document.getElementById('setting-call-num').value;
            const sms = document.getElementById('setting-sms-num').value;

            try {
                await setDoc(doc(db, 'settings', 'websiteSettings'), {
                    contactNumbers: { whatsapp, call, sms }
                }, { merge: true }); // Use merge to only update this part of the document
                showNotification('Contact numbers saved!', 'success');
                await loadSettings(); // Reload frontend settings
            } catch (error) {
                showNotification('Error saving contact numbers: ' + error.message, 'error');
                console.error("Error saving contact numbers:", error);
            }
        }

        async function savePaymentDetails(e) {
            e.preventDefault();
            const jazzcash = document.getElementById('setting-jazzcash-num').value;
            const easypaisa = document.getElementById('setting-easypaisa-num').value;
            const bankAccNo = document.getElementById('setting-bank-acc-no').value;
            const bankAccHolder = document.getElementById('setting-bank-acc-holder').value;
            const bankName = document.getElementById('setting-bank-name').value;

            try {
                await setDoc(doc(db, 'settings', 'websiteSettings'), {
                    paymentDetails: { jazzcash, easypaisa, bankAccNo, bankAccHolder, bankName }
                }, { merge: true });
                showNotification('Payment details saved!', 'success');
                await loadSettings(); // Reload frontend settings
            } catch (error) {
                showNotification('Error saving payment details: ' + error.message, 'error');
                console.error("Error saving payment details:", error);
            }
        }

        async function saveAutoReplyMessage(e) {
            e.preventDefault();
            const autoReply = document.getElementById('setting-auto-reply').value;

            try {
                await setDoc(doc(db, 'settings', 'websiteSettings'), {
                    autoReplyMessage: autoReply
                }, { merge: true });
                showNotification('Auto-reply message saved!', 'success');
                await loadSettings(); // Reload frontend settings
            } catch (error) {
                showNotification('Error saving auto-reply message: ' + error.message, 'error');
                console.error("Error saving auto-reply message:", error);
            }
        }

        // Utility functions
        window.scrollToMenu = () => {
            document.getElementById('menu').scrollIntoView({ behavior: 'smooth' });
        };

        window.openDirectWhatsApp = () => {
            const whatsappNum = frontendContactNumbers.whatsapp || '923188791637'; // Fallback
            window.open(`https://wa.me/${whatsappNum}`, '_blank');
        };

        window.makeCall = () => {
            const callNum = frontendContactNumbers.call || '923188791637'; // Fallback
            window.open(`tel:${callNum}`);
        };

        window.sendSMS = () => {
            const smsNum = frontendContactNumbers.sms || '923188791637'; // Fallback
            window.open(`sms:${smsNum}`);
        };

        window.copyToClipboard = (elementId) => {
            const textToCopy = document.getElementById(elementId).textContent;
            navigator.clipboard.writeText(textToCopy)
                .then(() => {
                    showNotification('Copied to clipboard!', 'success');
                })
                .catch(err => {
                    showNotification('Failed to copy text: ' + err, 'error');
                });
        };

        function showNotification(message, type) {
            const container = document.body;
            const toast = document.createElement('div');
            toast.className = `notification-toast alert alert-${type} d-flex align-items-center`;
            toast.setAttribute('role', 'alert');

            let icon = '';
            if (type === 'success') {
                icon = '<i class="fas fa-check-circle me-2"></i>';
            } else if (type === 'error') {
                icon = '<i class="fas fa-times-circle me-2"></i>';
            } else if (type === 'info') {
                icon = '<i class="fas fa-info-circle me-2"></i>';
            } else if (type === 'warning') {
                icon = '<i class="fas fa-exclamation-triangle me-2"></i>';
            }

            toast.innerHTML = `${icon}<div>${message}</div>`;
            container.appendChild(toast);

            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 500);
            }, 3000);
        }

    </script>
</body>

</html>
